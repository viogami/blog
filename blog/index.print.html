<!DOCTYPE html>
<html id="R-html" lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.154.5">
    <meta name="generator" content="Relearn 9.0.3+8bb66fa674351f3a0b0917a7552caac686eca920">
    <meta name="description" content="">
    <meta name="author" content="SÃ¶ren Weber">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://mcshelby.github.io/hugo-theme-relearn/images/hero.png">
    <meta name="twitter:title" content="Blog :: Hugo Relearn Theme">
    <meta property="og:url" content="https://mcshelby.github.io/hugo-theme-relearn/blog/index.html">
    <meta property="og:site_name" content="Hugo Relearn Theme">
    <meta property="og:title" content="Blog :: Hugo Relearn Theme">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://mcshelby.github.io/hugo-theme-relearn/images/hero.png">
    <meta itemprop="name" content="Blog :: Hugo Relearn Theme">
    <meta itemprop="datePublished" content="2025-01-20T00:00:00+00:00">
    <meta itemprop="dateModified" content="2025-01-20T00:00:00+00:00">
    <meta itemprop="image" content="https://mcshelby.github.io/hugo-theme-relearn/images/hero.png">
    <title>Blog :: Hugo Relearn Theme</title>
    <link href="https://mcshelby.github.io/hugo-theme-relearn/blog/index.html" rel="canonical" type="text/html" title="Blog :: Hugo Relearn Theme">
    <link href="/hugo-theme-relearn/blog/index.xml" rel="alternate" type="application/rss+xml" title="Blog :: Hugo Relearn Theme">
    <link href="/hugo-theme-relearn/images/logo.svg?1769070402" rel="icon" type="image/svg+xml">
    <link href="/hugo-theme-relearn/css/auto-complete/auto-complete.min.css?1769070402" rel="stylesheet">
    <script src="/hugo-theme-relearn/js/auto-complete/auto-complete.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/search-lunr.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/search.min.js?1769070402" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/hugo-theme-relearn/searchindex.en.js?1769070402";
    </script>
    <script src="/hugo-theme-relearn/js/lunr/lunr.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/lunr/lunr.stemmer.support.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/lunr/lunr.multi.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/lunr/lunr.en.min.js?1769070402" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/hugo-theme-relearn/fonts/fontawesome/css/all.min.css?1769070402" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/hugo-theme-relearn/fonts/fontawesome/css/all.min.css?1769070402" rel="stylesheet"></noscript>
    <link href="/hugo-theme-relearn/css/perfect-scrollbar/perfect-scrollbar.min.css?1769070402" rel="stylesheet">
    <link href="/hugo-theme-relearn/css/theme.min.css?1769070402" rel="stylesheet">
    <link href="/hugo-theme-relearn/css/format-print.min.css?1769070402" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/blog\/index.html';
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='https:\/\/mcshelby.github.io\/hugo-theme-relearn';
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // translations
      window.T_Copy_to_clipboard = `Copy text to clipboard`;
      window.T_Copied_to_clipboard = `Text copied to clipboard!`;
      window.T_Link_copied_to_clipboard = `Link copied to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      window.T_Browser_unsupported_feature = `This browser doesn't support this feature`;
      // variant stuff
      window.relearn.themevariants = [ 'relearn-auto', 'relearn-dark', 'relearn-light', 'relearn-bright', 'zen-auto', 'zen-dark', 'zen-light', 'retro-auto', 'neon', 'learn', 'blue', 'green', 'red' ];
      window.relearn.customvariantprefix = "my-custom-";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant") ?? "";
        if( !variant ||
            (!variant.startsWith(window.relearn.customvariantprefix) && !window.relearn.themevariants.includes(variant)) ||
            (variant.startsWith(window.relearn.customvariantprefix) && !window.localStorage.getItem(window.relearn.absBaseUri + "/variantstylesheet-" + variant)) ){
          variant = window.relearn.themevariants[0];
          window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
    <script src="/hugo-theme-relearn/js/variant.min.js?1769070402"></script>
    <style>
       
      #R-body img.bg-white {
        background-color: white;
      }
    </style>
  </head>
  <body class="mobile-support print" data-origin="/hugo-theme-relearn/blog/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar" class="default-animation">
        <div class="topbar-wrapper default-animation">
          <div class="topbar-sidebar-divider default-animation"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar default-animation" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-toc default-animation" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-table-list"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"> 
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class="a11y-only"><a itemprop="item" href="/hugo-theme-relearn/index.html"><span itemprop="name">Hugo Relearn Theme</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Blog</span><meta itemprop="position" content="2"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-edit default-animation" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="https://github.com/McShelby/hugo-theme-relearn/edit/main/docs/content/blog/_index.md" rel="external" target="_self" title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-print default-animation" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="/hugo-theme-relearn/blog/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-prev default-animation" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="/hugo-theme-relearn/project/uma_drawcard_2/index.html" title="ã€PYQTã€‘èµ›é©¬å¨˜æŠ½å¡æ¨¡æ‹Ÿå™¨-åŸºäºBwikiçš„æŠ½å¡æ¨¡æ‹Ÿ(ä¸‹) (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-next default-animation" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><a href="/hugo-theme-relearn/blog/tls-mitmproxy-clash/index.html" title="TLSæµé‡è§£å¯†ï¼ŒmitmproxyæŠ“åŒ…æ¨¡æ‹Ÿå™¨æµé‡èµ°clashä»£ç†è¯ä¹¦é—®é¢˜ (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>
            <div class="topbar-button topbar-button-more default-animation" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle button link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable blog" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="blog">Blog</h1>


  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jan 20, 2025
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Blog</h1>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/clash/index.html">Clash</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/mitmproxy/index.html">Mitmproxy</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/tls/index.html">TLS</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E6%A8%A1%E6%8B%9F%E5%99%A8/index.html">æ¨¡æ‹Ÿå™¨</a></li>
  </ul>
</div>
  </header>

<h1 id="tlsæµé‡è§£å¯†mitmproxyæŠ“åŒ…æ¨¡æ‹Ÿå™¨æµé‡èµ°clashä»£ç†è¯ä¹¦é—®é¢˜">TLSæµé‡è§£å¯†ï¼ŒmitmproxyæŠ“åŒ…æ¨¡æ‹Ÿå™¨æµé‡èµ°clashä»£ç†è¯ä¹¦é—®é¢˜</h1>

<p><strong>æ‰€è°“tlsåŠ å¯†ï¼Œå…¶å®å°±æ˜¯httpsï¼Œæˆ–è€…æ˜¯wssï¼Œä½†æ˜¯wssä¹Ÿæ˜¯httpsçš„å‡çº§ã€‚æ‰€ä»¥è§£å¯†tlså®é™…ä¸Šå°±æ˜¯è§£è¯»httpsæµé‡ã€‚</strong></p>
<h3 id="é—®é¢˜åœºæ™¯">é—®é¢˜åœºæ™¯<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>å·¥å…·ï¼š mitmproxy,mumuæ¨¡æ‹Ÿå™¨12ï¼Œclashï¼Œwireshake(å¯é€‰)ï¼Œopensslï¼Œadbè°ƒè¯•</p>
<p>mumuæ¨¡æ‹Ÿå™¨å¯åŠ¨æ¸¸æˆï¼Œå¸Œæœ›æŠ“å…¶ä¼ å‘æœåŠ¡å™¨çš„åŒ…ï¼Œå®ç°ä¸€äº›è‡ªåŠ¨åŒ–æ“ä½œã€‚ç”±äºæ¸¸æˆæ˜¯æ—¥æœï¼Œæ‰€ä»¥éœ€è¦å¯ç”¨ä»£ç†ã€‚æˆ‘ä½¿ç”¨äº†clashã€‚æ­¤å¤–ï¼Œæ¸¸æˆçš„åŒ…ä½¿ç”¨äº†tls1.3åŠ å¯†ï¼Œè¦æƒ³æˆªå–å¿…é¡»è·å¾—åœ¨æœ¬åœ°ç”Ÿæˆçš„å¯†é’¥è¿›è¡Œè§£å¯†æ‰èƒ½çŸ¥é“æ˜æ–‡ã€‚ä¸­é—´äººä»£ç†ï¼Œæˆ‘ä½¿ç”¨äº†mitmproxyã€‚</p>
<h3 id="é—®é¢˜æ˜¾éœ²">é—®é¢˜æ˜¾éœ²<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>mitmproxyå¯ä»¥ä»£ç†ä¸€ä¸ªæœ¬åœ°ç«¯å£ï¼Œåœ¨tls(https)æµé‡è¿›å…¥è¿›è¡Œæ¡æ‰‹é˜¶æ®µçš„æ—¶å€™ï¼Œé€šè¿‡é…ç½®è¯ä¹¦å¯ä»¥è§£è¯»æ˜æ–‡.ä½†é—®é¢˜æ˜¯æµé‡å¿…é¡»èµ°clashçš„ï¼Œä¸ç„¶æ²¡æ¢¯å­è®¿é—®ä¸äº†å›½å¤–çš„æœåŠ¡å™¨ã€‚è€Œclashä½œä¸ºä»£ç†å·¥å…·æ˜¯æ²¡æœ‰ä¿å­˜è¯¥keyçš„åŠŸèƒ½çš„ã€‚</p>
<h3 id="æ€è·¯">æ€è·¯<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>å¾ˆè‡ªç„¶çš„æƒ³æ³•ï¼Œè®©æ¨¡æ‹Ÿå™¨æµé‡å…ˆèµ°mitmproxyï¼Œè€Œåå†èµ°clashä½œä¸ºæµé‡å‡ºå…¥å£ï¼Œmitmproxyä½œä¸ºæ¨¡æ‹Ÿå™¨å’Œclashçš„ä¸­é—´äººã€‚è¿™æ ·å°±å¯ä»¥å®ç°æµé‡çš„æˆªå–å’Œæ¢¯å­è½¬å‘ï¼Œæœ€åé€šè¿‡å¦‚wiresharkè¿™ç±»çš„æŠ“åŒ…å·¥å…·è¿›è¡Œæ•°æ®åŒ…åˆ†æã€‚</p>
<p><a href="#R-image-41e0b4fc4b12e67244dbebc13eabea7f" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/tls-mitmproxy-clash/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-41e0b4fc4b12e67244dbebc13eabea7f"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/tls-mitmproxy-clash/1.png"></a></p>
<h3 id="è¯ä¹¦é—®é¢˜">è¯ä¹¦é—®é¢˜<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>è¿™æ ·çœ‹èµ·æ¥okäº†ï¼Œæ¨¡æ‹Ÿå™¨è®¿é—®ç½‘é¡µï¼Œåœ¨ç»ˆç«¯ä¹Ÿå¯ä»¥çœ‹åˆ°mitmproxyçš„æµé‡ç»è¿‡äº†ã€‚ä½†æ˜¯åœ¨å¯åŠ¨æ¸¸æˆçš„æ—¶å€™ï¼Œä¾ç„¶ä¼šçœ‹åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<blockquote>
<p>clinet TLS handshake failed. The client may not trust the proxys certificate for xxx.com(Openssl Error ssl routines , , tlsv1 alert access denied)</p>
</blockquote>
<p>å­—é¢æ„æ€ï¼Œmitmproxy åœ¨è¿›è¡Œ TLS æ¡æ‰‹æ—¶ï¼Œå®¢æˆ·ç«¯æ— æ³•ä¿¡ä»» mitmproxy çš„è¯ä¹¦ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œmitmproxy ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä¼ªé€ çš„è¯ä¹¦æ¥æ›¿ä»£ç›®æ ‡ç½‘ç«™çš„çœŸå®è¯ä¹¦ï¼Œä»¥ä¾¿è§£å¯†å’Œè½¬å‘æµé‡ã€‚å¦‚æœå®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨æˆ–æ¨¡æ‹Ÿå™¨ï¼‰æ²¡æœ‰ä¿¡ä»» mitmproxy çš„è¯ä¹¦ï¼Œå®ƒå°±ä¼šæ‹’ç»ä¸ä»£ç†çš„å®‰å…¨è¿æ¥ã€‚</p>
<p><strong>é‚£å°±å¾—åœ¨æ¨¡æ‹Ÿå™¨å®‰è£…ä¸Šmitmproxyçš„è¯ä¹¦ã€‚</strong>
é»˜è®¤æƒ…å†µä¸‹ï¼Œmitmproxy çš„è¯ä¹¦å­˜å‚¨è·¯å¾„æ˜¯ ~/.mitmproxy/ï¼ˆLinux/macOSï¼‰æˆ– C:\Users&lt;username&gt;.mitmproxy\ï¼ˆWindowsï¼‰ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶å« mitmproxy-ca-cert.pemã€‚
å°† mitmproxy-ca-cert.pem è¯ä¹¦æ–‡ä»¶ä¼ è¾“åˆ° Android è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ã€‚
æ‰“å¼€è®¾å¤‡çš„ è®¾ç½®ï¼Œæ‰¾åˆ° å®‰å…¨æ€§ æˆ– è¯ä¹¦ç®¡ç†ï¼Œç„¶åé€‰æ‹© ä»å­˜å‚¨å¯¼å…¥è¯ä¹¦ã€‚
é€‰æ‹©ä¸‹è½½çš„è¯ä¹¦æ–‡ä»¶å¹¶å¯¼å…¥ã€‚
å¯¼å…¥åï¼Œè®¾å¤‡åº”è¯¥ä¿¡ä»» mitmproxy çš„æ ¹è¯ä¹¦ã€‚</p>
<p>ä½†æ˜¯mumu12æ¨¡æ‹Ÿå™¨æ²¡æœ‰å¦‚ä¸Šè®¾ç½®ã€‚å¹¶ä¸æ˜¯æ— ä»–æ³•ã€‚
ç¬¬ä¸€æ­¥ï¼Œå®‰è£…openssl
ç¬¬äºŒæ­¥ï¼ŒæŠŠpemè¯ä¹¦é€šè¿‡opensslè½¬æ¢ä¸ºDERæ ¼å¼çš„è¯ä¹¦</p>
<p><code>openssl x509 -subject_hash_old -in mitmproxy-ca-cert.pem.pem</code></p>
<p>ç¬¬ä¸‰æ­¥ï¼Œé‡å‘½åpemæ–‡ä»¶ä¸º <code>å“ˆå¸Œå€¼.0</code>
<a href="#R-image-ebd759e331965de0059992da686b5bfd" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/tls-mitmproxy-clash/2.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ebd759e331965de0059992da686b5bfd"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/tls-mitmproxy-clash/2.png"></a></p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">adb root
</span></span><span class="line"><span class="cl">adb remount
</span></span><span class="line"><span class="cl">adb push xxxxxxx.0 /system/etc/security/cacerts/</span></span></code></pre></div>
<p><strong>å‚è€ƒå¸–å­ï¼š<a href="https://blog.csdn.net/haduwi/article/details/125696208" rel="external" target="_self">https://blog.csdn.net/haduwi/article/details/125696208</a></strong></p>
<h3 id="ç»“æŸ">ç»“æŸ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>å¯¼å…¥äº†è¯ä¹¦åï¼Œmitmproxyçš„event logå°±æ²¡æœ‰æŠ¥é”™äº†ï¼Œç¾æ»‹æ»‹ï¼Œå¼€å§‹ç”¨wiresharkè¿›è¡Œæ•°æ®åŒ…åˆ†æå§ã€‚</p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jan 20, 2025
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/c%23/index.html">C#</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/json/index.html">Json</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/protobuf/index.html">Protobuf</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/unity/index.html">Unity</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6/index.html">äºŒè¿›åˆ¶æ–‡ä»¶</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/index.html">æ¸¸æˆå¼€å‘</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E9%80%86%E5%90%91/index.html">é€†å‘</a></li>
  </ul>
</div>
  </header>

<h1 id="é€†å‘è§£å†³unityå¯¼å‡ºtextassetåéƒ¨åˆ†æ–‡æœ¬å‡ºç°ä¹±ç ">ã€é€†å‘ã€‘è§£å†³unityå¯¼å‡ºTextAssetåéƒ¨åˆ†æ–‡æœ¬å‡ºç°ä¹±ç </h1>

<p>é—®é¢˜é¢„è§ˆã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸ªé…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯åªæœ‰éƒ¨åˆ†æ–‡æœ¬å¯è¯»ã€‚</p>
<p><a href="#R-image-1ce91487ed981546175b5ae5e73a8f1e" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-1ce91487ed981546175b5ae5e73a8f1e"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/1.png"></a></p>
<p>è¯¥æ–‡ä»¶æ˜¯é€šè¿‡è§£åŒ…è½¯ä»¶ä»abåŒ…ç›´æ¥å¯¼å‡ºçš„ï¼Œä¸å­˜åœ¨abåŒ…åŠ å¯†çš„é—®é¢˜ã€‚
æ—¢ç„¶éƒ¨åˆ†æ–‡æœ¬å¯è¯»ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶åŠ å¯†çš„å¯èƒ½æ€§å¾ˆå°ï¼Œéƒ¨åˆ†åŠ å¯†è¿™ç§ä¹Ÿå¤ªå°ä¼—äº†ã€‚</p>
<p>æ—¢ç„¶æ˜¯æ¸¸æˆå·¥ç¨‹é¡¹ç›®ï¼Œè€ƒè™‘ä¸¤ä¸ªæ–¹å‘ï¼šæ˜¯å¦æ˜¯ç”¨protobuffè¯»å–çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼›æ˜¯å¦æ˜¯ç›´æ¥ç”¨è¯»å–å­—èŠ‚æµçš„æ–¹å¼è¯»å–çš„é…ç½®æ–‡ä»¶ã€‚</p>
<h3 id="æ˜¯å¦æ˜¯pbçš„äºŒè¿›åˆ¶æ–‡ä»¶">æ˜¯å¦æ˜¯pbçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ç›´æ¥æ‹¿åˆ°å¯¼å‡ºçš„äºŒçº§è¿›åˆ¶æ–‡ä»¶å¯¼å‡ºåˆ°è¯¥ç½‘ç«™è¯†åˆ«ï¼š
<a href="https://protobuf-decoder.netlify.app/" rel="external" target="_self">https://protobuf-decoder.netlify.app/</a></p>
<p><a href="#R-image-2e200e17e7104c3fb187643554128e46" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/2.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2e200e17e7104c3fb187643554128e46"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/2.png"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰è¯†åˆ«å‡ºåˆé€‚çš„å­—æ®µåã€‚æ®æ­¤åˆ¤æ–­è¯¥æ–‡æœ¬æ–‡ä»¶ä¸æ˜¯pbçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<h3 id="æ˜¯å¦æ˜¯æŒ‰å­—èŠ‚æµè¯»å–çš„æ–‡æœ¬">æ˜¯å¦æ˜¯æŒ‰å­—èŠ‚æµè¯»å–çš„æ–‡æœ¬ï¼Ÿ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æŒ‰ç…§å­—èŠ‚æµè¯»å–æ–‡æœ¬ï¼Œè¿™åœ¨å®¢æˆ·ç«¯ä¸­ä¸å°‘è§, å› ä¸ºæ¯”jsonçœç©ºé—´, ä½†ç¼ºç‚¹æ˜¯å¯è¯»æ€§ä¸º0, æˆ‘çš„è¯„ä»·å°±æ˜¯ç‹—å±, ä½ å°‘å‡ºå‡ å¼ å®½é«˜ä¸æ˜¯4çš„æ•´å€æ•°çš„å›¾, è¿™éƒ½ä¸ç”¨æ‰£è¿™ç‚¹é…ç½®è¡¨çœçš„ç©ºé—´ã€‚ã€‚åœ¨æºç ä¸­å¯èƒ½æ˜¯è¿™æ ·å‡ºç°çš„ï¼š
<a href="#R-image-64fd89c057921d7e82d90575f87560bc" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/3.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-64fd89c057921d7e82d90575f87560bc"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/3.png"></a>
<a href="#R-image-e5248f8f2ad875debe984fbf6143040d" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/4.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e5248f8f2ad875debe984fbf6143040d"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/4.png"></a></p>
<p>ä½¿ç”¨010 editoræ‰“å¼€è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚é€å­—èŠ‚è¿›è¡Œè§‚å¯Ÿåˆ†æï¼šæ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½æœ‰ç›¸åŒçš„4Bæ–‡ä»¶å¤´ï¼Œéšåæ˜¯æ–‡ä»¶é•¿åº¦çš„16è¿›åˆ¶ï¼Œç„¶åæ˜¯ç›¸åŒçš„4Bå­—èŠ‚â€œ00 00 00 01â€,å†ä¹‹åæ˜¯é…ç½®æ–‡ä»¶çš„é…ç½®é¡¹æ•°ï¼Œæœ€åæ˜¯4Bçš„æ ¡éªŒæ¯”ç‰¹ã€‚æ€»ä¹‹å°±æ˜¯å¼€å¤´çš„20Bä¸ºé…ç½®æ–‡ä»¶çš„æè¿°æ–‡ä»¶å¤´ã€‚
<a href="#R-image-fce0c5a29300b0ee171006bb50e0298e" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/5.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fce0c5a29300b0ee171006bb50e0298e"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/5.png"></a></p>
<h3 id="è·å¾—äºŒè¿›åˆ¶æ–‡æœ¬çš„å­—æ®µæè¿°">è·å¾—äºŒè¿›åˆ¶æ–‡æœ¬çš„å­—æ®µæè¿°<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æ­¤å¤„éœ€è¦é€†å‘ä»£ç ï¼Œç”±äºæ˜¯ill2cppæ‰“åŒ…çš„ï¼Œåªèƒ½dumpå‡ºå‡½æ•°åï¼Œä½†ä¹Ÿå¤Ÿç”¨äº†ã€‚åœ¨dnspyä¸­æœç´¢å’Œé…ç½®æ–‡ä»¶åŒåçš„é¡¹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå®šä¹‰äº†æ‰€æœ‰é…ç½®æ–‡ä»¶modelçš„æ–‡ä»¶å¤¹<strong>ResDef</strong>ã€‚å…¶ä¸­å®šä¹‰äº†é…ç½®æ–‡ä»¶çš„å­—æ®µå†…å®¹ï¼š
<a href="#R-image-662d864e221e2d9f4dddad2431a38d02" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/6.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-662d864e221e2d9f4dddad2431a38d02"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/6.png"></a></p>
<p>è¯¥é¡¹ç›®ç¡®å®æ˜¯ç”¨protobuffè¿›è¡Œé€šä¿¡çš„ï¼Œä½†é…ç½®æ–‡ä»¶è¿˜æ˜¯jsonæ ¼å¼çš„ï¼Œå…¶ä¸­é…ç½®å­—æ®µä¹Ÿç¬¦åˆjsonåµŒå¥—çš„æ ¼å¼ã€‚æˆ‘ä»¬é€æ¯”ç‰¹è¿›è¡Œå­—æ®µè§£è¯»ï¼Œå‘ç°å­—èŠ‚æµç¡®å®æ˜¯å¯è¯»çš„ã€‚å…¶ä¸­éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p>
<ul>
<li>è¿™ç§ç”±å¼€å‘è€…è‡ªå®šä¹‰çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸€èˆ¬éƒ½æ˜¯<strong>å¤§ç«¯åº</strong>è¯»å–çš„å­—èŠ‚ï¼Œç›´æ¥ç”¨<code>readbytes</code>æ–¹æ³•ä¸åˆé€‚ï¼Œè¦é€†åºä¸€ä¸‹ã€‚</li>
<li>æ³¨æ„å…¶ä¸­çš„stringç±»å‹çš„æ¯”ç‰¹ç¼–ç æ–¹å¼ï¼Œä¸€èˆ¬æ˜¯ç”±4Bæ–‡ä»¶æŒ‡å®šé•¿åº¦ï¼Œåé¢è¯¥é•¿åº¦çš„å­—èŠ‚ç¼–ç ä¸ºå­—ç¬¦ä¸²ã€‚</li>
<li>æ³¨æ„æ•°ç»„ç±»å‹åœ¨å­—èŠ‚æµæ–‡ä»¶ä¸­çš„ç¼–ç æ–¹å¼ï¼Œå¯èƒ½å’Œå­—ç¬¦ä¸²ä¸€æ ·ç”¨4BæŒ‡å®šé•¿åº¦ï¼Œä¹Ÿå¯èƒ½æ˜¯å®šé•¿ç¼–ç ã€‚æœ¬ç¤ºä¾‹é¡¹ç›®ä¸­å°±æ˜¯å®šé•¿ç¼–ç ï¼Œæ‰€æœ‰æ•°ç»„å¤§å°éƒ½å›ºå®šä¸º3ã€‚</li>
</ul>
<p>é…ç½®å­—æ®µçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">AchieveBaseConfig</span> <span class="p">:</span> <span class="n">ProtoBaseStruct</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="n">SortNO</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">uint</span> <span class="n">ID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">string</span> <span class="n">Desc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">byte</span> <span class="n">Classify</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">byte</span> <span class="n">ClassifySubType</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">byte</span> <span class="n">ShowProgress</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">ResBehaviorRule</span> <span class="n">Behavior</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">uint</span> <span class="n">BootyID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">uint</span> <span class="n">MaxProgress</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">uint</span> <span class="n">JumpID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="k">class</span> <span class="nc">ResBehaviorRule</span> <span class="p">:</span> <span class="n">ProtoBaseStruct</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="n">Type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span><span class="p">[]</span> <span class="n">Param</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>é€æ¯”ç‰¹å¯¹æ¯”ï¼Œç¬¦åˆå­—æ®µçš„å®šä¹‰ï¼š
<a href="#R-image-d764628ea27c6ba4b1198e34258535fe" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/7.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d764628ea27c6ba4b1198e34258535fe"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/decrypt-textasset-garbled/7.png"></a></p>
<h3 id="ç¼–å†™è§£å¯†ä»£ç ">ç¼–å†™è§£å¯†ä»£ç <span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ç¼–å†™è§£å¯†å‡½æ•°ç±»BinaryConfigParserï¼Œæ ¹æ®å­—æ®µç±»å‹é€è¡Œè¯»å–ï¼Œæ³¨æ„å¤§å°ç«¯å¤„ç†ï¼Œå­—ç¬¦ä¸²å’Œæ•°ç»„ç±»å‹å¤„ç†ä»¥åŠåµŒå¥—ç±»å‹çš„å¤„ç†(éœ€è¦é€’å½’)ï¼Œæœ€ååœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨ã€‚å¦‚ä¸‹åªç»™å‡ºä¸»å‡½æ•°çš„è°ƒç”¨éƒ¨åˆ†ï¼Œ<code>BinaryConfigParser</code>ç±»è¿‡é•¿ï¼Œä¸”è§£ç ä¸åŒäºŒè¿›åˆ¶æ–‡ä»¶æ–¹æ³•ä¹Ÿä¸ç›¸åŒï¼Œå°±æœªæ”¾å‡ºï¼Œå¦‚éœ€è¦å¯ç•™è¨€ã€‚</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// è§£ç äºŒè¿›åˆ¶æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="k">void</span> <span class="n">Decode</span><span class="p">(</span><span class="kt">string</span> <span class="n">fileName</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arrayLen</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">binaryFilePath</span> <span class="p">=</span> <span class="s">$&#34;TextAsset\\{fileName}&#34;</span><span class="p">;</span> <span class="c1">// æ›¿æ¢ä¸ºå®é™…çš„äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// åŠ¨æ€è·å–ç±»å‹</span>
</span></span><span class="line"><span class="cl">        <span class="n">Type</span> <span class="n">type</span> <span class="p">=</span> <span class="n">Type</span><span class="p">.</span><span class="n">GetType</span><span class="p">(</span><span class="s">$&#34;ResDef.{fileName}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// åŠ¨æ€è°ƒç”¨æ³›å‹æ–¹æ³•</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">method</span> <span class="p">=</span> <span class="k">typeof</span><span class="p">(</span><span class="n">BinaryConfigParser</span><span class="p">).</span><span class="n">GetMethod</span><span class="p">(</span><span class="s">&#34;ReadConfigArray&#34;</span><span class="p">).</span><span class="n">MakeGenericMethod</span><span class="p">(</span><span class="n">type</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1">// è¯»å–é…ç½®é¡¹</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">configs</span> <span class="p">=</span> <span class="n">method</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span> <span class="p">{</span> <span class="n">binaryFilePath</span><span class="p">,</span> <span class="n">arrayLen</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ä¿å­˜ä¸º JSON æ•°ç»„æ ¼å¼</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">jsonArray</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">SerializeObject</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">Formatting</span><span class="p">.</span><span class="n">Indented</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ä¿å­˜åˆ°æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">jsonOutputPath</span> <span class="p">=</span> <span class="s">$&#34;output_json\\{fileName}.json&#34;</span><span class="p">;</span> <span class="c1">// æ›¿æ¢ä¸ºå®é™…çš„ JSON è¦å­˜æ”¾çš„æ–‡ä»¶è·¯å¾„</span>
</span></span><span class="line"><span class="cl">        <span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="n">jsonOutputPath</span><span class="p">,</span> <span class="n">jsonArray</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;æ–‡ä»¶ {fileName} å·²è§£ç ä¸º JSON æ–‡ä»¶: {jsonOutputPath}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">//è‡ªåŠ¨åŒ–è§£ç </span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="k">void</span> <span class="n">AutoDecode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">textAssetFolder</span> <span class="p">=</span> <span class="s">&#34;TextAsset&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">string</span> <span class="n">outputFolder</span> <span class="p">=</span> <span class="s">&#34;output_json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ç¡®ä¿è¾“å‡ºæ–‡ä»¶å¤¹å­˜åœ¨</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(!</span><span class="n">Directory</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Directory</span><span class="p">.</span><span class="n">CreateDirectory</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è·å–TextAssetæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">        <span class="kt">var</span> <span class="n">files</span> <span class="p">=</span> <span class="n">Directory</span><span class="p">.</span><span class="n">GetFiles</span><span class="p">(</span><span class="n">textAssetFolder</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// éå†æ‰€æœ‰æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">filePath</span> <span class="k">in</span> <span class="n">files</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">string</span> <span class="n">fileName</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetFileName</span><span class="p">(</span><span class="n">filePath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="kt">string</span> <span class="n">outputJsonPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">outputFolder</span><span class="p">,</span> <span class="s">$&#34;{fileName}.json&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// æ£€æŸ¥æ˜¯å¦å·²ç”ŸæˆJSONæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(!</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">outputJsonPath</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// // è¾“å…¥å›ºå®šæ•°ç»„é•¿åº¦,ç”±äºé•¿åº¦æœªçŸ¥,æ‰€ä»¥å¾ªç¯100æ¬¡ï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„é•¿åº¦</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// for (int arrayLen = 0; arrayLen &lt; 100; arrayLen++)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// {</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">//     // è°ƒç”¨Decodeç”ŸæˆJSON</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">//     Decode(fileName, arrayLen);</span>
</span></span><span class="line"><span class="cl">                    <span class="c1">// }</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">arrayLen</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Decode</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">arrayLen</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&#34;å¤„ç†æ–‡ä»¶ {fileName} å¤±è´¥ï¼&#34;</span><span class="p">+</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ç¨‹åºå…¥å£</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">AutoDecode</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jan 6, 2025
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/c&#43;&#43;/index.html">C&#43;&#43;</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/c&#43;&#43;-build-tools/index.html">C&#43;&#43; Build Tools</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/c&#43;&#43;-cmake-tools-for-windows/index.html">C&#43;&#43; Cmake Tools for Windows</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/rider/index.html">Rider</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/ue5/index.html">Ue5</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/vs2022/index.html">Vs2022</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/index.html">å¼€å‘ç¯å¢ƒ</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/index.html">æ¸¸æˆå¼€å‘</a></li>
  </ul>
</div>
  </header>

<h1 id="ç”¨æœ€è½»é‡çš„vsè´Ÿè½½è¿›è¡Œue5å¼€å‘ä½¿ç”¨rider">ç”¨æœ€è½»é‡çš„VSè´Ÿè½½è¿›è¡ŒUE5å¼€å‘(ä½¿ç”¨rider)</h1>

<p>ä»UE5å®˜æ–¹æ–‡æ¡£æ¥çœ‹ï¼Œè¦ä¸‹çš„è´Ÿè½½è¿˜æ˜¯å¾ˆå¤šçš„ã€‚ä½†æŸ¥çœ‹riderå®˜æ–¹æ–‡æ¡£ï¼Œåªè¦æˆ‘ä»¬ä¸‹ä¸€ä¸ªvsçš„å·¥å…·é›†å°±okäº†ï¼Œé‚£å°±è¯•è¯•çœ‹ã€‚</p>
<p><a href="#R-image-8709fec428fd138a25908a5959fc7e74" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-8709fec428fd138a25908a5959fc7e74"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/1.png"></a></p>
<p><strong>ä¸‹è½½ Visual Studio Build Toolsï¼š</strong></p>
<p>è®¿é—® Visual Studio å®˜æ–¹ç½‘ç«™ ä¸‹è½½ Visual Studio Build Toolsã€‚</p>
<p><a href="#R-image-d8362823e7ea84019719faca21a55de3" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/2.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d8362823e7ea84019719faca21a55de3"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/2.png"></a></p>
<p>è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹©æ‰€éœ€çš„ç»„ä»¶ï¼š</p>
<ul>
<li>
<p>é€‰æ‹©â€œ<strong>C++ build tools</strong>â€ï¼Œè¿™æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ã€‚
åœ¨å®‰è£…é€‰é¡¹ä¸­é€‰æ‹©ï¼š
MSVC v142 - VS 2019 C++ x64/x86 build toolsï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬,æˆ‘ç”¨2022ï¼‰
Windows 11 SDKï¼ˆwin10æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰
C++ CMake tools for Windows</p>
</li>
<li>
<p>é€‰æ‹©â€œ<strong>å•ä¸ªç»„ä»¶</strong>â€ä¸­çš„.NETæ¡†æ¶SDKã€‚</p>
</li>
</ul>
<p><a href="#R-image-a63766119bbbe76161b70b03684fbd0c" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/3.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a63766119bbbe76161b70b03684fbd0c"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/ue5-rider-vs/3.png"></a></p>
<p>å¼€å§‹å®‰è£…ï¼Œç­‰å¾…å®‰è£…å®Œæˆã€‚</p>
<p><strong>é…ç½® Unreal Engine 5</strong>
åœ¨å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œå¯ä»¥é…ç½® Unreal Engine 5 ä½¿ç”¨è¿™äº›å·¥å…·æ¥ç¼–è¯‘é¡¹ç›®ã€‚</p>
<p>1.å¯åŠ¨ Unreal Engine 5 å¹¶æ‰“å¼€é¡¹ç›®ã€‚
2.è½¬åˆ°â€œç¼–è¾‘â€ -&gt; â€œé¡¹ç›®è®¾ç½®â€ã€‚åœ¨å·¦ä¾§èœå•ä¸­æ‰¾åˆ°â€œå¹³å°â€ -&gt; â€œWindowsâ€ã€‚ç¡®è®¤ç¼–è¯‘å™¨è·¯å¾„ æŒ‡å‘åˆšå®‰è£…çš„ MSVC ç¼–è¯‘å·¥å…·ï¼Œvs2022ã€‚
3.è½¬åˆ°â€ç¼–è¾‘å™¨åå¥½è®¾ç½®â€œ -&gt;&ldquo;é€šç”¨&rdquo; -&gt; &ldquo;æºä»£ç &rdquo; ï¼Œé€‰æ‹©ç¼–è¾‘å™¨ä¸º &ldquo;rider&rdquo;</p>
<hr>
<p>è¿™æ ·å°±å®Œæˆäº†æœ€è½»é‡çš„ä½¿ç”¨rideråšç¼–è¾‘å™¨è¿›è¡ŒUE5å¼€å‘äº†ï¼Œ<strong>ä¸ä¸‹è½½vs2022çš„ç¼–è¾‘å™¨ï¼Œåªä¸‹è½½å¿…è¦æ„å»ºå·¥å…·ï¼Œç¼–è¾‘å™¨ä½¿ç”¨rider</strong>ã€‚</p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Jun 12, 2024
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/docker/index.html">Docker</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/linux/index.html">Linux</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/mysql/index.html">Mysql</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/windows/index.html">Windows</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98/index.html">å¼€å‘é—®é¢˜</a></li>
  </ul>
</div>
  </header>

<h1 id="å¼€å‘é—®é¢˜linuxå¯åŠ¨dockeré•œåƒæˆåŠŸè€Œwinå¯åŠ¨è¯¥é•œåƒmysqlæŠ¥é”™">ã€å¼€å‘é—®é¢˜ã€‘linuxå¯åŠ¨dockeré•œåƒæˆåŠŸï¼Œè€Œwinå¯åŠ¨è¯¥é•œåƒmysqlæŠ¥é”™</h1>

<ul>
<li>dockersæŠ¥é”™ï¼š<code>Starting MySQL database server mysqld ...failed</code></li>
<li>è¿›å…¥å®¹å™¨å†…éƒ¨ï¼ŒæŸ¥çœ‹mysqlé”™è¯¯æ—¥å¿—ï¼š<code>cat /var/log/mysql/error.log</code></li>
<li>mysqlå…·ä½“æŠ¥é”™ï¼š<code>Different lower_case_table_names settings for server ('2') and data dictionary ('0').</code></li>
</ul>
<p><strong>å‡ºç°è¯¥é—®é¢˜çš„é‡è¦å‰ææ˜¯ï¼š</strong></p>
<ul>
<li>dockerå¯åŠ¨mysqlå¹¶ä¸æ˜¯æ ¹æ®å®˜æ–¹mysqlé•œåƒï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªåŸºç¡€phpé•œåƒä¸Šå®‰è£…çš„mysqlæœåŠ¡ã€‚</li>
<li>æˆ‘çš„mysqlæ•°æ®é€šè¿‡dockerçš„å·æŒ‚è½½åœ¨å¤–éƒ¨ï¼Œé€šè¿‡ä¸€ä¸ªmysqlæ–‡ä»¶å¤¹ç®¡ç†ã€‚</li>
</ul>
<p>å½“æˆ‘æŠŠlinuxä¸Šå¯ä»¥è¿è¡Œçš„é•œåƒå’Œmysqlå¤–éƒ¨å·éƒ½å‘é€ç»™winæœºå™¨è¿è¡Œï¼Œç”±äº<strong>mysqlæ•°æ®æ˜¯å¤–éƒ¨æŒ‚è½½çš„</strong>ï¼Œæ‰€ä»¥ä¼šå‡ºç°åŒä¸€ä¸ªé•œåƒï¼Œæ¢äº†æ“ä½œç³»ç»Ÿå´æ— æ³•è¿è¡Œçš„é—®é¢˜ã€‚æœ¬è´¨ä¸Šæ˜¯mysqlåœ¨linuxå’Œwinä¸Šçš„ç¯å¢ƒå˜é‡<code>lower_case_table_names</code>é»˜è®¤å€¼ä¸åŒå¯¼è‡´çš„ã€‚ç”±äºæ•°æ®åº“æ•°æ®åœ¨linuxä¸Šåˆå§‹åŒ–ï¼Œè¯¥å€¼å·²ç»ä¸º0ï¼Œè€Œåœ¨winä¸Šéœ€è¦ä¸º2ï¼Œæ‰€ä»¥æŠ¥é”™ã€‚</p>
<blockquote>
<p>Dockeré•œåƒç¡®å®æ˜¯æ“ä½œç³»ç»Ÿæ— å…³çš„ï¼Œä½†æ˜¯MySQLçš„lower_case_table_namesè®¾ç½®æ˜¯ä¸æ“ä½œç³»ç»Ÿæœ‰å…³çš„ã€‚è¿™æ˜¯å› ä¸ºlower_case_table_namesè®¾ç½®å†³å®šäº†MySQLå¦‚ä½•å­˜å‚¨å’Œæ¯”è¾ƒè¡¨åå’Œæ•°æ®åº“åã€‚</p>
<p>åœ¨Windowså’ŒMacç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿé€šå¸¸ä¸åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤MySQLé»˜è®¤å°†lower_case_table_namesè®¾ç½®ä¸º2ã€‚åœ¨è¿™ç§è®¾ç½®ä¸‹ï¼ŒMySQLå°†è¡¨åå­˜å‚¨ä¸ºå°å†™ï¼Œå¹¶ä¸”æ¯”è¾ƒæ—¶ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>åœ¨Linuxç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿé€šå¸¸åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤MySQLé»˜è®¤å°†lower_case_table_namesè®¾ç½®ä¸º0ã€‚åœ¨è¿™ç§è®¾ç½®ä¸‹ï¼ŒMySQLå°†è¡¨åå­˜å‚¨ä¸ºç»™å®šçš„å¤§å°å†™ï¼Œå¹¶ä¸”æ¯”è¾ƒæ—¶åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>å½“ä½ åœ¨ä¸€ä¸ªç³»ç»Ÿï¼ˆä¾‹å¦‚Windowsï¼‰ä¸Šåˆ›å»ºMySQLæ•°æ®ï¼Œç„¶åå°è¯•åœ¨å¦ä¸€ä¸ªç³»ç»Ÿï¼ˆä¾‹å¦‚Linuxï¼‰ä¸Šä½¿ç”¨è¿™äº›æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºæ•°æ®å­—å…¸ï¼ˆå­˜å‚¨äº†è¡¨åå’Œæ•°æ®åº“åçš„å…ƒæ•°æ®ï¼‰çš„lower_case_table_namesè®¾ç½®ä¸æœåŠ¡å™¨çš„è®¾ç½®ä¸ä¸€è‡´ã€‚</p>
</blockquote>
<h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>è§£å†³ä¸ªè›‹ï¼Œä¸€èˆ¬éƒ½æ˜¯æ”¾åœ¨linuxä¸Šè¿è¡Œçš„ï¼Œmysqlåœ¨å“ªåˆå§‹åŒ–å°±åœ¨å“ªéƒ¨ç½²ã€‚å°†é•œåƒå’Œå¤–éƒ¨å·éƒ½æ”¾åœ¨linuxæœºå™¨ä¸Šéƒ¨ç½²å°±å¥½äº†ã€‚winä¸ŠæŠ¥é”™è¦å¯åŠ¨mysqlå‰ä¿®æ”¹é‚£ä¸ªç¯å¢ƒå˜é‡çš„å€¼ã€‚</p>
<p>æˆ–è€…æœ‰ä¸€ç§éº»çƒ¦çš„æ€è·¯ï¼Œå°±æ˜¯å°†å…¶mysqlæœåŠ¡ä»ä¸€ä¸ªå®¹å™¨ä¸­å‰¥ç¦»å‡ºæ¥ï¼Œæ–°å¼€ä¸€ä¸ªå®¹å™¨å¯åŠ¨ï¼Œè¿™æ ·æ–¹ä¾¿è®¾ç½®ç¯å¢ƒå˜é‡ã€‚å¦‚æœè¦ä¿®æ”¹ä¸€ä¸ªémysqlåŸºç¡€é•œåƒçš„mysqlç¯å¢ƒå˜é‡è¿˜æ˜¯æ¯”è¾ƒç¹ççš„ã€‚æ–°å¼€ä¸€ä¸ªå®¹å™¨ï¼Œç”¨docker-composeå¯åŠ¨å³å¯ã€‚</p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Apr 27, 2024
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/agones/index.html">Agones</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/docker/index.html">Docker</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/k8s/index.html">K8S</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/kubernetes/index.html">Kubernetes</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/index.html">äº‘åŸç”Ÿ</a></li>
  </ul>
</div>
  </header>

<h1 id="è‡ªé¡¶å‘ä¸‹å­¦ä¹ k8s--éƒ¨ç½²agones">è‡ªé¡¶å‘ä¸‹å­¦ä¹ K8S--éƒ¨ç½²Agones</h1>

<p>å­¦ä¸€ä¸ªæ–°äº‹ç‰©ä»åº•å±‚ç†è®ºå­¦è‚¯å®šæ˜¯æœ€ç³»ç»Ÿçš„ï¼Œä½†ä¸æ˜¯æœ€å·¥ç¨‹çš„ã€‚å¯¹äºK8Sï¼Œæˆ‘ä¸ªäººè®¤ä¸ºç›¸æ¯”è‹¦è‹¦ç†è§£å„ç§é›†ç¾¤ï¼ŒèŠ‚ç‚¹ï¼Œpodsç­‰ç­‰æ¦‚å¿µï¼Œä¸å¦‚å®é™…ä¸Šæ‰‹ä¸€æ¬¡ï¼Œä»å®è·µä¸Šé€æ­¥ç†è§£ç†è®ºï¼Œè‡ªé¡¶å‘ä¸‹æ‰æ˜¯æœ€å¿«æœ€é«˜æ•ˆçš„å­¦ä¹ æ¨¡å¼ï¼Œå› ä¸ºç›®çš„æ˜¯ä½¿ç”¨K8Sï¼Œæ˜¯å·¥ç¨‹åŒ–ï¼Œè€Œä¸æ˜¯äº†è§£k8sæ¶æ„ï¼Œè®¾è®¡äº‘äº‘ã€‚</p>
<p><strong>æœ¬æ–‡åŸºæœ¬ä»0å¼€å§‹éƒ¨ç½²Agonesï¼Œè¿›è€Œé€æ­¥ç†è§£dockerï¼Œç†è§£K8Sã€‚</strong></p>
<p>ç›¸ä¿¡å¦‚æœä½ èƒ½å‘ç°æœ¬æ–‡ï¼Œè‡ªç„¶äº†è§£Agonesæ˜¯ä»€ä¹ˆï¼Œå¦‚æœä¸çŸ¥é“è‡ªè¡Œäº†è§£ä¸‹ï¼Œä¸åšå¤šä»‹ç»ï¼Œå¼•ç”¨å®˜æ–¹ä»‹ç»ï¼š</p>
<blockquote>
<p>Agones æ˜¯ä¸€ä¸ªå¼€æºå¹³å°ï¼Œç”¨äºéƒ¨ç½²ã€æ‰˜ç®¡ã€æ‰©å±•å’Œç¼–æ’ä¸“ç”¨æ¸¸æˆæœåŠ¡å™¨ï¼Œç”¨äºå¤§å‹å¤šäººæ¸¸æˆï¼Œæ„å»ºåœ¨è¡Œä¸šæ ‡å‡†çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¹³å°
Kubernetes ä¹‹ä¸Šã€‚</p>
</blockquote>
<p>éƒ¨ç½²Agonesåªæ˜¯ä¸€ä¸ªä»»åŠ¡æ€§çš„å¼•å­ï¼Œé‡ç‚¹è¿˜æ˜¯K8S.</p>
<h2 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<h3 id="å®‰è£…docker-desktop">å®‰è£…docker-desktop<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ç”±äºæˆ‘æ˜¯winæœºå™¨ï¼Œåœ¨ä¸€åˆ‡ä¹‹å‰ï¼Œå¾—ä»‹ç»ä¸‹å¼€å‘ç¯å¢ƒï¼Œä½†å¾ˆç®€å•ã€‚
é¦–å…ˆå¾—å®‰è£…dockerï¼Œæ³¨æ„å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œçœ‹çœ‹cpuæœ‰æ²¡æœ‰å¼€å¯è™šæ‹ŸåŒ–ï¼Œæ²¡æœ‰åˆ™åœ¨biosè®¾ç½®ä¸­å¼€å¯ã€‚(å¿…è¦)</strong></li>
<li>å®‰è£…wslï¼Œæ— éœ€å¼€å¯hyper-v,æ‰€ä»¥å®¶åº­è¿˜æ˜¯ä¸“ä¸šç‰ˆçš„windowsæ²¡å•¥å½±å“ã€‚</li>
<li>è‡ªå¤‡ä»£ç†å·¥å…·ï¼Œdockerå®˜ç½‘éœ€è¦é­”æ³•ã€‚</li>
</ul>
<p><strong>å®‰è£…å®ŒdockeråŸºæœ¬å°±å®Œæˆäº†ã€‚</strong></p>
<p>ç”±äºæ˜¯ä¸ªäººå¼€å‘æµ‹è¯•ç”¨ï¼Œåªç”¨<strong>éƒ¨ç½²ä¸€ä¸ªå•èŠ‚ç‚¹é›†ç¾¤</strong>å°±å¥½äº†ï¼Œè€Œè¿™åœ¨docker-desktopä¸­å·²ç»é›†æˆäº†ï¼Œå¾ˆæ–¹ä¾¿ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæ‰“å¼€å³å¯ï¼š</p>
<p><a href="#R-image-53da94f9200f947c8fde1220de58aa2b" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-53da94f9200f947c8fde1220de58aa2b"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/1.png"></a></p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl get nodes</span></span></code></pre></div>
<p>å¦‚æœè¿”å›ç±»ä¼¼ Ready çŠ¶æ€çš„èŠ‚ç‚¹ï¼Œè¯´æ˜ Kubernetes å·²ç»å¯åŠ¨æˆåŠŸã€‚</p>
<p><em>æ³¨æ„ âŒï¼šDocker Desktop çš„ Kubernetes åªèƒ½è¿è¡Œåœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒçš„é«˜å¯ç”¨é›†ç¾¤ã€‚</em></p>
<h3 id="vscodeçš„k8sæ’ä»¶">vscodeçš„K8Sæ’ä»¶<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>å®‰è£…æ¡Œé¢ç‰ˆçš„dockeræ˜¯æœ‰å›¾å½¢åŒ–ç•Œé¢çš„ï¼Œå¾ˆç›´è§‚ï¼Œä½†K8Sç›®å‰æˆ‘ä»¬æ˜¯æ²¡æœ‰GUIçš„ï¼Œéœ€è¦å—ï¼Ÿå¹¶ä¸ä¸€å®šï¼Œä½¿ç”¨guiä¼šæ›´å¤šçš„é™åˆ¶ä½ ã€‚
Kubernetes æœ¬èº«ä¸»è¦æ˜¯é€šè¿‡ kubectl å‘½ä»¤è¡Œå·¥å…·å’Œ YAML é…ç½®æ–‡ä»¶è¿›è¡Œç®¡ç†çš„ã€‚</p>
<p>è™½ç„¶æœ‰ <code>kubernetes-dashboard</code>ï¼Œä½†åˆ«ç€æ€¥ï¼Œåœ¨vscodeçš„æ’ä»¶ä¹Ÿæœ‰guiå¯ä»¥æ‰“å¼€dashboardã€‚æ¨èå®‰è£…dockerå’Œk8sæ’ä»¶ï¼Œåœ¨vscodeä¸­é›†æˆå¼€å‘ï¼Œç„¶åæˆ‘é€æ­¥è§£é‡Šä¸‹æ’ä»¶ä¸­æ¯ä¸ªæ˜¾ç¤ºé¡¹çš„ä½œç”¨ï¼Œ<strong>ä»è¿™é‡Œå°±å¼€å§‹ç†è§£å¦‚ä½•ä½¿ç”¨K8Sè¾£</strong></p>
<p><a href="#R-image-f384618aa0791557e059930ccde191f7" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/2.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f384618aa0791557e059930ccde191f7"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/2.png"></a></p>
<ul>
<li>Namespaceï¼ˆå‘½åç©ºé—´ï¼‰Kubernetes å†…éƒ¨çš„é€»è¾‘éš”ç¦»å•ä½ï¼Œç”¨äºåˆ’åˆ†ä¸åŒçš„åº”ç”¨ã€ç¯å¢ƒæˆ–å›¢é˜Ÿã€‚ä¸€ä¸ªé›†ç¾¤å¯ä»¥åŒ…å«å¤šä¸ª Namespaceï¼Œ<strong>æ¯ä¸ª Namespace å†…çš„èµ„æºç›¸äº’ç‹¬ç«‹</strong>ã€‚</li>
<li>Workloadsï¼ˆå·¥ä½œè´Ÿè½½ï¼‰ç®¡ç† Kubernetes é‡Œè¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ è¿è¡Œ Pod çš„æ§åˆ¶å™¨ã€‚Workload è´Ÿè´£å®šä¹‰åº”ç”¨å¦‚ä½•éƒ¨ç½²ã€æ‰©ç¼©å®¹ã€æ›´æ–°å’Œè¿è¡Œã€‚</li>
<li>Networkï¼ˆç½‘ç»œï¼‰ è´Ÿè´£ Kubernetes Pod ä¹‹é—´ã€Pod å’Œå¤–éƒ¨ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ã€‚ç®¡ç† Serviceã€Ingressã€Network Policy è¿™äº› K8s ç½‘ç»œèµ„æºã€‚</li>
<li>Storageï¼ˆå­˜å‚¨ï¼‰ç®¡ç† Kubernetes é‡Œçš„æŒä¹…åŒ–å­˜å‚¨ï¼Œç¡®ä¿ Pod é‡æ–°å¯åŠ¨åæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚Volume åªåœ¨ Pod ç”Ÿå‘½å‘¨æœŸå†…æœ‰æ•ˆï¼Œä½† PersistentVolumeï¼ˆPVï¼‰å¯æŒä¹…å­˜å‚¨æ•°æ®ã€‚</li>
<li>Configurationï¼ˆé…ç½®ç®¡ç†ï¼‰ç®¡ç†åº”ç”¨çš„é…ç½®ä¿¡æ¯ã€ç¯å¢ƒå˜é‡ã€Secretsï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰ã€‚è®©åº”ç”¨å’Œç¯å¢ƒè§£è€¦ï¼Œæ¯”å¦‚å¯ä»¥åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹æ›´æ”¹åº”ç”¨é…ç½®ã€‚</li>
<li>Custom Resourceï¼ˆè‡ªå®šä¹‰èµ„æºï¼‰æ‰©å±• Kubernetesï¼Œå¢åŠ æ–°çš„èµ„æºç±»å‹ï¼Œæ¯”å¦‚ Agones æ·»åŠ äº† GameServer èµ„æºã€‚å…è®¸ä½  åˆ›å»ºè‡ªå·±çš„ K8s APIï¼Œä»¥é€‚é…ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li>Helm Releasesï¼ˆHelm ç‰ˆæœ¬ç®¡ç†ï¼‰ç®¡ç† Helm å®‰è£…çš„åº”ç”¨ï¼ˆæ¯”å¦‚ agonesï¼‰ã€‚<strong>Helm æ˜¯ Kubernetes çš„åŒ…ç®¡ç†å·¥å…·</strong>ï¼Œå¯ä»¥ä¸€é”®å®‰è£…ã€æ›´æ–°ã€åˆ é™¤å¤æ‚åº”ç”¨ã€‚</li>
</ul>
<h4 id="ä½†docker-desktop-ä¸åŒ…å«k8sçš„åŒ…ç®¡ç†å·¥å…·-helm">ä½†Docker Desktop ä¸åŒ…å«K8Sçš„åŒ…ç®¡ç†å·¥å…· Helm<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4>
<p>ä½†å®‰è£…äº†K8Sæ’ä»¶ä¼šè‡ªåŠ¨æç¤ºä¸‹è½½ <code>kubectl</code>å’Œ <code>helm</code>ï¼Œå‰è€…æ˜¯å‘½ä»¤è¡Œæ“ä½œå·¥å…·ã€‚éƒ½æ˜¯ç¼–è¯‘å¥½çš„exeã€‚å¦‚æœéœ€è¦å¯ä»¥é…åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œä½ç½®åœ¨ <code>.../user/.vs-kubernetes</code>ä¸‹</p>
<h2 id="æå‡ºç–‘é—®-åŒºåˆ«æ¦‚å¿µ">æå‡ºç–‘é—®-åŒºåˆ«æ¦‚å¿µ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>å¥½äº†ï¼Œåœ¨éƒ¨ç½²ä¹‹å‰ï¼Œå®‰è£…äº†ä¸Šæ–‡æ‰€è¯´çš„æ’ä»¶ï¼Œå¦‚æœåˆšå…¥é—¨K8Sï¼Œéš¾å…æœ‰ä¸€äº›ç–‘é—®ï¼Œä¸‹é¢æˆ‘ç€é‡è¿›è¡Œäº›æ¦‚å¿µè¡¥å……ï¼Œå¸Œæœ›ä¸‹é¢å¯ä»¥é¡ºåˆ©è¿›è¡Œ~</p>
<h3 id="kubernetes-ä¸­-node-å’Œ-pod-çš„å…³ç³»">Kubernetes ä¸­ Node å’Œ Pod çš„å…³ç³»<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>Nodeï¼ˆèŠ‚ç‚¹ï¼‰å°±æ˜¯æœºå™¨ï¼Œå®ƒå¯ä»¥æ˜¯ï¼šç‰©ç†æœºï¼ˆè£¸æœºæœåŠ¡å™¨ï¼‰ï¼Œè™šæ‹Ÿæœºï¼ˆäº‘æœåŠ¡å™¨ã€Docker Desktop é‡Œçš„è™šæ‹Ÿ K8s èŠ‚ç‚¹ï¼‰ï¼Œä½ çš„æœ¬æœºï¼ˆå¦‚æœä½ ç”¨ Docker Desktop Kubernetesï¼‰</p>
<p>Podï¼ˆPod æ˜¯å®¹å™¨çš„å°è£…å•ä½ï¼‰ï¼ŒPod è¿è¡Œåœ¨ Nodeä¸Šï¼Œä¸€ä¸ªPod é‡Œé¢å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼ŒPodå…±äº«å­˜å‚¨ï¼ˆVolumeï¼‰ã€ç½‘ç»œï¼ˆIP åœ°å€ï¼‰ç­‰ï¼ŒK8s åªç®¡ç† Podï¼Œä¸ç›´æ¥ç®¡ç†å®¹å™¨</p>
<p>å¦‚æœ Kubernetes æ˜¯ä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼š</p>
<ul>
<li>Node = ä¸€å°æœåŠ¡å™¨</li>
<li>Pod = æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªåº”ç”¨è¿›ç¨‹ç»„ï¼ˆå¯èƒ½åŒ…å«å¤šä¸ªå®¹å™¨ï¼‰</li>
<li>å®¹å™¨ = è¿è¡Œçš„è¿›ç¨‹ï¼ˆæ¯”å¦‚ Nginxã€MySQL ç­‰ï¼‰</li>
</ul>
<h3 id="ç°å®ä¸­ä¸€ä¸ªé¡¹ç›®æ˜¯ä¸æ˜¯åªè¦ä¸€ä¸ªk8sé›†ç¾¤å°±å¤Ÿäº†">ç°å®ä¸­ï¼Œä¸€ä¸ªé¡¹ç›®æ˜¯ä¸æ˜¯åªè¦ä¸€ä¸ªk8sé›†ç¾¤å°±å¤Ÿäº†ï¼Ÿ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p><strong>YESï¼ä¸€ä¸ª Kubernetes é›†ç¾¤è¶³å¤Ÿåº”ä»˜ç»å¤§éƒ¨åˆ†çš„é¡¹ç›®éœ€æ±‚ï¼ŒåŒ…æ‹¬æ‰©å±•ã€å¼¹æ€§ã€èµ„æºç®¡ç†å’Œå®¹å™¨çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚</strong></p>
<p>ä¸€ä¸ªK8Sé›†ç¾¤ä¸­ä¼šæœ‰å¾ˆå¤šnodesï¼Œè¿™äº›nodeså°±æ˜¯ç‰©ç†ä¸Šçš„æœºå™¨ï¼Œå¯ä»¥æœ‰å¾ˆå¤šä¸ªï¼Œæ¯ä¸ªnodesé‡Œæœ‰å¾ˆå¤špodsï¼Œpodsæ‰æ˜¯å®é™…çš„éƒ¨ç½²çš„åº”ç”¨ã€‚nodeså·²ç»å®Œæˆäº†åˆ†å¸ƒå¼ï¼Œå¤šé›†ç¾¤å¯èƒ½ç¡®å®åœ¨å¤§å‹å¤æ‚é¡¹ç›®çš„è·¨åœ°åŒºéƒ¨ç½²ä¸­ç”¨åˆ°ï¼Œä½†å’±å¯ä»¥ä¸ç”¨äº†è§£</p>
<h3 id="å‘½åç©ºé—´å’Œnodesæœ‰ä»€ä¹ˆåŒºåˆ«ä¸ºä»€ä¹ˆæœ‰äº†nodesè¿˜éœ€è¦namespace">å‘½åç©ºé—´å’Œnodesæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆæœ‰äº†nodesè¿˜éœ€è¦namespace<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<ul>
<li>Nodesï¼ˆèŠ‚ç‚¹ï¼‰ ç‰©ç†æˆ–è™šæ‹Ÿæœºï¼Œè´Ÿè´£è¿è¡Œ Pod å®é™…çš„è®¡ç®—èµ„æºï¼ˆCPUã€å†…å­˜ã€å­˜å‚¨ï¼‰</li>
<li>Namespaceï¼ˆå‘½åç©ºé—´ï¼‰ é€»è¾‘éš”ç¦»çš„ç¯å¢ƒï¼Œç®¡ç†ä¸åŒçš„ K8s èµ„æº é€»è¾‘ä¸Šçš„ç»„ç»‡å•ä½ï¼Œä¸å½±å“ç‰©ç†èµ„æºåˆ†é…
<em>å¯ä»¥æŠŠ Node ç†è§£ä¸º &ldquo;çœŸå®çš„æœåŠ¡å™¨&rdquo;ï¼Œè€Œ Namespace æ›´åƒæ˜¯ &ldquo;åº”ç”¨çš„æ–‡ä»¶å¤¹æˆ–é¡¹ç›®ç©ºé—´&rdquo;</em></li>
</ul>
<h2 id="å®‰è£…agones">å®‰è£…Agones<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>å¥½äº†ï¼Œç»ˆäºæ¥åˆ°é‡ç‚¹ä¹Ÿä¸ç®—æ˜¯é‡ç‚¹çš„éƒ¨åˆ†äº†ã€‚</p>
<h3 id="ä½†å¹¶ä¸é‡è¦å› ä¸ºä½ å¯ä»¥æ ¹æ®å®˜æ–¹æ–‡æ¡£é€æ­¥æ“ä½œ">ä½†å¹¶ä¸é‡è¦ï¼Œå› ä¸ºä½ å¯ä»¥æ ¹æ®<a href="https://agones.dev/site/docs/installation/install-agones/yaml/" rel="external" target="_self">å®˜æ–¹æ–‡æ¡£</a>é€æ­¥æ“ä½œ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æ ¹æ®agoneså®˜æ–¹æ–‡æ¡£ï¼Œå®‰è£…å¯ä»¥é€šè¿‡yamlæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡helmåŒ…ç®¡ç†å®‰è£…ã€‚</p>
<p>æˆ‘æ˜¯ç”¨kubectlå‘½ä»¤è¡Œæ‹‰å–çš„yamlæ–‡ä»¶å®Œæˆçš„å®‰è£…</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">kubectl create namespace agones-system
</span></span><span class="line"><span class="cl">kubectl apply --server-side -f https://raw.githubusercontent.com/googleforgames/agones/release-1.48.0/install/yaml/install.yaml</span></span></code></pre></div>
<p>ç„¶åä½ å°±å¯ä»¥åœ¨ <code>Custom Resource</code>ä¸­å‘ç°æ‹‰å»ä¸‹æ¥çš„æœåŠ¡äº†ï¼</p>
<p><a href="#R-image-6dfa575d15a1e5f0a186856d44fb8c29" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/3.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6dfa575d15a1e5f0a186856d44fb8c29"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/3.png"></a></p>
<p>æ¥ä¸‹æ¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ“ä½œè¿›è¡Œéƒ¨ç½²äº†ï¼Œå¹¶ä¸èµ˜è¿°ï¼Œå› ä¸ºæœ¬æ–‡ä¸æ˜¯ä»‹ç»æ€ä¹ˆéƒ¨ç½²agonesã€‚</p>
<p><a href="#R-image-22a8e7f33d081b9bc865ce793151bbae" class="lightbox-link"><img alt="alt text" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/4.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-22a8e7f33d081b9bc865ce793151bbae"><img alt="alt text" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/k8s-agones/4.png"></a></p>
<p>æœ¬äººä½¿ç”¨rideråŠå…¶K8Sæ’ä»¶ï¼Œåœ¨æ¸¸æˆå¼€å‘çš„æ—¶å€™è¿›è¡ŒæœåŠ¡å™¨é›†ç¾¤æ§åˆ¶çš„ã€‚è®°ä½å‘½ä»¤è¡Œå¾—åˆ°podçš„ipå’Œç«¯å£ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç½‘ç»œé€šä¿¡çš„çŸ¥è¯†äº†ã€‚å¦‚æœè¦åœ¨unityä¸­å’Œéƒ¨ç½²çš„æœåŠ¡å™¨åº”ç”¨é€šä¿¡ï¼Œè‡ªå†™å’Œåç«¯çš„é€šä¿¡åè®®ï¼ŒAgonesåªæ˜¯ä¸ªåå°åº”ç”¨è°ƒåº¦å·¥å…·ï¼Œä¸æ¶‰åŠå’Œå‰ç«¯äº¤äº’ã€‚</p>
<p><strong>æ³¨æ„ âŒ Agones Unity SDK é€‚ç”¨äº æœåŠ¡å™¨ç«¯ï¼ˆGameServerï¼‰ çš„ Unity è¿›ç¨‹è€Œä¸æ˜¯å‰ç«¯ï¼</strong></p>
<p>ä¾‹å¦‚ï¼šä½ ç”¨ Unity åˆ¶ä½œäº†ä¸€æ¬¾ æœåŠ¡å™¨ç«¯æ¨¡æ‹Ÿçš„æ¸¸æˆé€»è¾‘ï¼Œéœ€è¦è®© Agones è°ƒåº¦è¿™ä¸ªæœåŠ¡å™¨ã€‚æˆ–è€…ä½ çš„æ¸¸æˆæœåŠ¡å™¨æ˜¯ Unity ç¼–å†™çš„ï¼Œæƒ³è¦ä¸ Agones äº¤äº’æ¥ç®¡ç†å®ƒçš„ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯ï¼Œ<strong>å¦‚æœä½ æƒ³è®© Unity å®¢æˆ·ç«¯ è¿æ¥åˆ° GameServerï¼Œé‚£ Unity SDK å¹¶ä¸éœ€è¦ã€‚å®¢æˆ·ç«¯åº”è¯¥ç›´æ¥ç”¨ WebSocketã€TCPã€UDPã€HTTP è¿æ¥ GameServerã€‚</strong></p>
<h2 id="ç»“æŸ">ç»“æŸ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>æ€ä¹ˆå°±ç»“æŸäº†ï¼Ÿ
å› ä¸ºä»å®‰è£…agonesæ•²ä¸‹ä¸€è¡Œå‘½ä»¤è¡Œå¼€å§‹ï¼Œå·²ç»å®Œæˆäº†ä¸€æ¬¡K8Sçš„ä½“éªŒï¼Œåªè¦äº†è§£ä»0åˆ°å¯åŠ¨ä¸€ä¸ªK8Så•èŠ‚ç‚¹é›†ç¾¤çš„å…¨è¿‡ç¨‹æ¯ä¸ªæ“ä½œçš„æ„ä¹‰ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œå·²ç»å…¥é—¨K8Säº†ï¼Œå°±è¿™ä¹ˆç®€å•ï¼Œå‰©ä¸‹çš„å†…å®¹éœ€è¦åœ¨ä¸€æ¬¡æ¬¡éƒ¨ç½²åº”ç”¨ï¼Œä¸€æ¬¡æ¬¡å¼€å…³å®¹å™¨ä¸­ä¸æ–­ç§¯ç´¯å§ã€‚è¿™ä¸æ˜¯æ•´ä½“å›¾çœ‹è¿™ä¸ªæ¦‚å¿µé‚£ä¸ªæ¦‚å¿µæ˜¯ä»€ä¹ˆæ„æ€å¯ä»¥è§£å†³çš„ã€‚</p>
<p>æ€ä¹ˆç”¨kubectlæ“ä½œï¼Œæ€ä¹ˆç”¨helmåŒ…ç®¡ç†ï¼Œè¿™å°±æ˜¯å¯åŠ¨K8SåäºŸå¾…è§£å†³çš„å”¯äºŒçš„é—®é¢˜ï¼Œåœ¨å®è·µä¸­ç»“æŸå§ï¼</p>
<h3 id="å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®éƒ½å¯ä»¥è¯„è®ºè”ç³»æˆ‘">å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®ï¼Œéƒ½å¯ä»¥è¯„è®ºè”ç³»æˆ‘~<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Mar 28, 2024
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc/index.html">GRPC</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc-go/index.html">Grpc-Go</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc-php/index.html">Grpc-Php</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc-python/index.html">Grpc-Python</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/php/index.html">Php</a></li>
  </ul>
</div>
  </header>

<h1 id="phpä½¿ç”¨grpcæœåŠ¡ä»0å¼€å§‹å¹¶ä¸”åŒ…å«mapfieldæ–‡ä»¶è§£é‡Š">phpä½¿ç”¨grpcæœåŠ¡(ä»0å¼€å§‹ï¼Œå¹¶ä¸”åŒ…å«mapfieldæ–‡ä»¶è§£é‡Š)</h1>

<p>grpcæ˜¯é¢å¯¹å¾®æœåŠ¡æ¡†æ¶è€Œé£ç”Ÿæ°´èµ·çš„ï¼Œä¸Šæ¬¡æˆ‘ç”¨pythonç¼–å†™äº†ä¸€ä¸ªå›¾ç¥ç»ç½‘ç»œå¤„ç†çš„å¾®æœåŠ¡ï¼Œä½¿ç”¨grpcæ”¾åœ¨æˆ‘çš„æœåŠ¡å™¨æœ¬åœ°ç«¯å£ä¸Šã€‚</p>
<p>ç°åœ¨æˆ‘å¸Œæœ›æˆ‘çš„ä¸€ä¸ªphpé¡¹ç›®ä¹Ÿå¯ä»¥è°ƒç”¨è¯¥æœåŠ¡ï¼Œç°åœ¨æ¥è¯•ä¸€è¯•å§~</p>
<h2 id="æµç¨‹">æµç¨‹<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<ul>
<li>phpçš„æœåŠ¡å™¨å®‰è£…protoc</li>
<li>phpçš„æœåŠ¡å™¨å®‰è£…grpc</li>
<li><del>ç¼–å†™æœåŠ¡ç«¯ä»£ç </del></li>
<li>ç¼–å†™å®¢æˆ·ç«¯ä»£ç </li>
</ul>
<p>ç”±äºæœåŠ¡ç«¯(python)çš„ä»£ç å·²ç»ç¼–å†™æˆ–è€…è¯´å·²ç»éƒ¨ç½²ï¼Œå°±ä¸åšå™è¿°äº†ã€‚</p>
<p>å®‰è£…ä»£ç è¯·æ ¹æ®è‡ªå·±çš„phpç‰ˆæœ¬å’Œgrpcç‰ˆæœ¬é…Œæƒ…è‡ªå®šä¹‰ã€‚æœ¬äººä½¿ç”¨çš„php8.0ï¼Œgrpc1.62.0ï¼Œprotobuf4.62.0</p>
<h2 id="å®‰è£…protocè§£é‡Šå™¨">å®‰è£…protocè§£é‡Šå™¨<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>å’Œwindowså¼€å‘ä¸€æ ·ï¼Œä½¿ç”¨grpcæœåŠ¡å‡éœ€è¦ä½¿ç”¨protocè§£é‡Šå™¨ï¼Œå»å®˜æ–¹githubä¸‹çš„releaseä¸‹è½½linuxç‰ˆæœ¬ï¼š
<a href="https://github.com/protocolbuffers/protobuf/releases/download/v26.0/protoc-26.0-linux-x86_64.zip" rel="external" target="_self">protoc-26.0-linux-x86_64.zip</a></p>
<p>è§£å‹åˆ° <code>/usr/bin/</code>ç›®å½•ä¸‹</p>
<blockquote>
<p>å¦‚æœä½ ä½¿ç”¨å®å¡”ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å…ˆåœ¨æœ¬åœ°ç”µè„‘ä¸Šè§£å‹ï¼ŒæŠŠè§£å‹åçš„binæ–‡ä»¶å¤¹é‡Œçš„protocæ–‡ä»¶ä¸Šä¼ åˆ° <code>/usr/bin/</code>ä¸­å°±å¥½äº†ã€‚</p>
</blockquote>
<p>ç»ˆç«¯ä¸­è¾“å…¥ <code>protoc</code>,æœ‰è¿”å›å³ä¸ºæˆåŠŸ</p>
<h2 id="å®‰è£…grpc">å®‰è£…grpc<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>æ— è®ºä½ æœåŠ¡å™¨æ˜¯å¦å®‰è£…peclï¼Œå¯ä»¥ç›´æ¥é€šè¿‡httpè¯·æ±‚å®‰è£…phpç›¸å…³åŒ…ï¼Œä½†æ˜¯å¿…é¡»å®‰è£…äº†php(åºŸè¯)</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½è§£å‹ grpc</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">wget http://pecl.php.net/get/grpc-1.62.0.tgz
</span></span><span class="line"><span class="cl">tar xvf grpc-1.62.0.tgz
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> grpc-1.62.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆé…ç½®å¹¶ç¼–è¯‘å®‰è£…(ç¼–è¯‘å®‰è£…æ—¶é—´å¾ˆé•¿ï¼Œæˆ‘å¤§æ¦‚å®‰è£…äº†ä¸€å°æ—¶å·¦å³)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ³¨æ„é€‰æ‹©ä½ è‡ªå·±çš„è·¯å¾„ä»¥åŠphpç‰ˆæœ¬ï¼Œæˆ‘æ˜¯80</span>
</span></span><span class="line"><span class="cl">/www/server/php/80/bin/phpize
</span></span><span class="line"><span class="cl">./configure --with-php-config<span class="o">=</span>/www/server/php/80/bin/php-config
</span></span><span class="line"><span class="cl">make <span class="o">&amp;&amp;</span> make install</span></span></code></pre></div>
<p>ä¹‹åè¦é…ç½®phpçš„æ‹“å±•
<strong>æ³¨æ„ï¼Œè¿™æ˜¯å¿…è¦çš„ï¼Œcomposeå®‰è£…çš„grpcä¾èµ–ï¼Œåº•å±‚è¿˜æ˜¯è°ƒç”¨çš„è¿™ä¸ªgrpcæ‹“å±•ï¼</strong></p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># é…ç½®PHPæ‰©å±•</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> grpc-1.62.0
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;extension = grpc.so&#34;</span> &gt;&gt; /www/server/php/80/etc/php.ini
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> protobuf-4.62.0  <span class="c1"># å¦‚æœæ²¡æœ‰è·¯å¾„è¯·ä»¿ç…§grpcå®‰è£…çš„æ–¹å¼æ‰‹åŠ¨å®‰è£…å®‰è£…ä¸€ä¸‹ï¼Œæˆ‘ä¸ªäººè§‰å¾—å¯èƒ½å¹¶ä¸éœ€è¦</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;extension = protobuf.so&#34;</span> &gt;&gt; /www/server/php/80/etc/php.ini</span></span></code></pre></div>
<p>æœ€åé‡å¯ä¸€ä¸‹phpå’ŒnginxæœåŠ¡å°±å¤§åŠŸå‘Šæˆäº†</p>
<h2 id="ç¼–è¯‘protocæ–‡ä»¶">ç¼–è¯‘protocæ–‡ä»¶<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>å…·ä½“çš„protocæ–‡ä»¶çš„å®šä¹‰è¯¦ç»†è§æˆ‘<a href="http://viogami.me/index.php/archives/158/" rel="external" target="_self">ä¹‹å‰çš„åšå®¢</a></p>
<p>éœ€è¦å®‰è£…protocå’Œgrpc_php_plugin</p>
<p>ä½¿ç”¨å¦‚ä¸‹ä»£ç ç”Ÿæˆï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">protoc --php_out ./ you-file.proto  <span class="c1">#éœ€è¦å®‰è£…protocè§£é‡Šå™¨ï¼Œç”Ÿæˆprotocçš„phpå®šä¹‰æ–‡ä»¶åœ¨å½“å‰ç›®å½•(./)</span>
</span></span><span class="line"><span class="cl">protoc --grpc_out ./ you-file.proto <span class="c1">#éœ€è¦grpc_php_pluginæ’ä»¶å®‰è£…ï¼Œç”Ÿæˆgrpcæ–‡ä»¶åœ¨å½“å‰ç›®å½•</span></span></span></code></pre></div>
<p>ç¬¬ä¸€è¡Œç”Ÿæˆä½ çš„protoæ•°æ®å®šä¹‰æ–‡ä»¶ï¼Œæˆ‘ç”Ÿæˆäº† <code>GCNResult.php</code>,<code>Node.php</code>,<code>Edge.php</code>,<code>GraphData.php</code>,
åŒæ—¶è¿˜ä¼šç”Ÿæˆä¸€ä¸ªGPBMetaDataæ–‡ä»¶å¤¹ã€‚
ç¬¬äºŒè¡Œç”Ÿæˆphpçš„grpcæ–‡ä»¶ï¼š<code>GCNServiceClient.php</code></p>
<p>æ³¨æ„ï¼Œå¦‚æœä½ æ²¡æœ‰ç”Ÿæˆgrpcæ–‡ä»¶çš„æ’ä»¶(å®‰è£…grpcå‡ºç°é—®é¢˜)ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½è¯¥æ’ä»¶
ç„¶åé€šè¿‡å¦‚ä¸‹ä»£ç ç”Ÿæˆ <code>xxxClient.php</code>æ–‡ä»¶</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">protoc --grpc_out ./ --plugin<span class="o">=</span>protoc-gen-grpc<span class="o">=</span>/your-path-to-plugin/grpc_php_plugin you-filename.proto
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:: è‡ªç”¨
</span></span><span class="line"><span class="cl">:: protoc --grpc_out ./ --plugin<span class="o">=</span>protoc-gen-grpc<span class="o">=</span>/opt/share/grpc_php_plugin gcn.proto</span></span></code></pre></div>
<h2 id="ç¼–å†™phpè¯·æ±‚çš„ä»£ç å®¢æˆ·ç«¯ä»£ç ">ç¼–å†™phpè¯·æ±‚çš„ä»£ç (å®¢æˆ·ç«¯ä»£ç )<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<h3 id="ç¼–å†™æ–‡ä»¶å‰ç½®æ³¨æ„äº‹é¡¹">ç¼–å†™æ–‡ä»¶å‰ç½®æ³¨æ„äº‹é¡¹<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<ul>
<li><strong>æ³¨æ„ï¼šå¦‚æœä½ ä½¿ç”¨å®å¡”ï¼Œéœ€è¦æŠŠphpè®¾ç½®é‡Œçš„ç¦ç”¨å‡½æ•° <code>putenv</code>å’Œ <code>proc_open</code>ç»™åˆ é™¤ï¼Œä¸ç„¶composerå®‰è£…æ— æ³•è¿›è¡Œã€‚</strong></li>
<li>éœ€è¦ç¼–å†™composer.jsonæ–‡ä»¶ï¼Œå› ä¸ºä½¿ç”¨äº† <code>dirname(__FILE__).'/vendor/autoload.php'</code>è¯¥è‡ªåŠ¨å¯¼å…¥åŠŸèƒ½ã€‚jsonæ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š</li>
</ul>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;require&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;grpc/grpc&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;google/protobuf&#34;</span><span class="p">:</span> <span class="s2">&#34;*&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;autoload&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;psr-4&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;GPBMetadata\\&#34;</span><span class="p">:</span> <span class="s2">&#34;protoc/GPBMetadata/&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;protoc\\&#34;</span><span class="p">:</span> <span class="s2">&#34;protoc/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>ç¼–å†™ååœ¨æœåŠ¡å™¨è¯¥æ–‡ä»¶ç›®å½•ä¸‹å¯åŠ¨ç»ˆç«¯è¾“å…¥ <code>composer install</code>å³å¯ï¼Œä¼šç”Ÿæˆvendoræ–‡ä»¶å¤¹</p>
<p>ç°åœ¨æˆ‘å°†ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„phpæ–‡ä»¶æ¥è°ƒç”¨è¿™ä¸ªæœåŠ¡ã€‚</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="nx">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">)</span><span class="o">.</span><span class="s1">&#39;/vendor/autoload.php&#39;</span><span class="p">;</span> <span class="c1">// å¼•å…¥ gRPC PHP æ‰©å±•çš„è‡ªåŠ¨åŠ è½½æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;protoc/GraphData.php&#39;</span><span class="p">;</span> <span class="c1">// å¼•å…¥åŒ…å« protocæ–‡ä»¶å¤¹ä¸‹çš„grpcç”Ÿæˆæ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;protoc/Node.php&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;protoc/Edge.php&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;protoc/GCNResult.php&#39;</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s1">&#39;protoc/GCNServiceClient.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è¿›è¡Œgrpcè¯·æ±‚ï¼Œè·å–gcnå¤„ç†åçš„æ•°æ®ï¼Œè¿”å›jsonå­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">GCN_request</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GCNServiceClient</span><span class="p">(</span><span class="s1">&#39;localhost:9999&#39;</span><span class="p">,</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;credentials&#39;</span> <span class="o">=&gt;</span> <span class="nx">\Grpc\ChannelCredentials</span><span class="o">::</span><span class="na">createInsecure</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="p">]);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1">// åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„å›¾æ•°æ®
</span></span></span><span class="line"><span class="cl">    <span class="nv">$G_example</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GraphData</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$G_example</span><span class="o">-&gt;</span><span class="na">setNodes</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="k">new</span> <span class="nx">Node</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">setId</span><span class="p">(</span><span class="s2">&#34;node1&#34;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setFeatures</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="k">new</span> <span class="nx">Node</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">setId</span><span class="p">(</span><span class="s2">&#34;node2&#34;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setFeatures</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">    <span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$G_example</span><span class="o">-&gt;</span><span class="na">setEdges</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="k">new</span> <span class="nx">Edge</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">setSourceId</span><span class="p">(</span><span class="s2">&#34;node1&#34;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setTargetId</span><span class="p">(</span><span class="s2">&#34;node2&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">]);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="c1">// å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”
</span></span></span><span class="line"><span class="cl">    <span class="k">list</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="nv">$status</span><span class="p">)</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="na">ProcessGraph</span><span class="p">(</span><span class="nv">$G_example</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$status</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">!==</span> <span class="nx">Grpc\STATUS_OK</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// gRPC è¯·æ±‚å‡ºé”™
</span></span></span><span class="line"><span class="cl">    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;Error calling grpc server -&gt; ProcessGraph: &#39;</span> <span class="o">.</span> <span class="nv">$status</span><span class="o">-&gt;</span><span class="na">details</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å› ä¸ºæˆ‘çš„è¿”å›ç»“æœæ˜¯ä¸ªmapæ•°æ®ç±»å‹ï¼Œphpä¸­æ²¡æœ‰è¯¥ç±»å‹ï¼Œéœ€è¦åšä¸€ä¸ªéå†å–å€¼ï¼Œå¦‚æœæ˜¯stringç±»å‹å¯ä»¥ç›´æ¥å–ã€‚
</span></span></span><span class="line"><span class="cl">    <span class="nv">$NodeScores</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">getNodeScores</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$NodeScores</span><span class="p">[</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$NodeScores</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªjsonæ•°æ®ï¼Œæƒ³è¦ä¿®æ”¹å¯ä»¥ä½¿ç”¨ <code>json_decode()</code> , è‡³æ­¤ï¼Œå¤§åŠŸå‘Šæˆï¼</p>
<h2 id="å¤‡æ³¨">å¤‡æ³¨<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>å› ä¸ºæˆ‘çš„protocæ–‡ä»¶çš„è¿”å›ç»“æœå®šä¹‰ä¸ºä¸€ä¸ªmapï¼Œè¿™æ˜¯goæ‰æœ‰çš„æ•°æ®ç»“æ„ï¼Œphpæ²¡æœ‰
ä½¿ç”¨ <code>var_dump($response-&gt;getNodeScores())</code>å¯ä»¥çœ‹åˆ°è¿™æ˜¯è°·æ­Œgrpcæ ¸å¿ƒä¸­å®šä¹‰çš„ä¸€ä¸ªmapfield objectï¼Œå¯ä»¥ç›´æ¥åƒgoçš„mapä¸€æ ·ï¼Œç”¨ <code>$response-&gt;getNodeScores()['xxx']</code>è·å–å€¼ã€‚</p>
<p>è™½ç„¶å®˜ç½‘æ˜¾ç¤ºæœ‰ToString()çš„æ–¹æ³•ï¼š<a href="https://cloud.google.com/dotnet/docs/reference/Google.Protobuf/latest/Google.Protobuf.Collections.MapField-2#Google_Protobuf_Collections_MapField_2_ToString" rel="external" target="_self">https://cloud.google.com/dotnet/docs/reference/Google.Protobuf/latest/Google.Protobuf.Collections.MapField-2#Google_Protobuf_Collections_MapField_2_ToString</a>
ä½†æ˜¯åœ¨è¿™é‡Œæ— æ³•ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘åªèƒ½é€šè¿‡éå†çš„æ–¹å¼è·å–æ‰€æœ‰å€¼å­˜åˆ°ä¸€ä¸ªæ•°ç»„é‡Œï¼Œæ¯•ç«Ÿmapç»“æ„æœ¬èº«å°±ä¸æ”¯æŒä¸€æ¬¡è·å–å…¨éƒ¨ï¼Œè¿˜æ˜¯è¦éå†ã€‚</p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>
  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Mar 24, 2024
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/go/index.html">Go</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc/index.html">GRPC</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc-go/index.html">Grpc-Go</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/grpc-python/index.html">Grpc-Python</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/python/index.html">Python</a></li>
  </ul>
</div>
  </header>

<h1 id="ä½¿ç”¨grpcåœ¨goåç«¯å’ŒpythonæœåŠ¡é—´é€šä¿¡">ä½¿ç”¨grpcåœ¨goåç«¯å’ŒpythonæœåŠ¡é—´é€šä¿¡</h1>

<h2 id="grpcå‰è¨€">grpcå‰è¨€<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>gRPCæ˜¯Google å¼€å‘çš„é«˜æ€§èƒ½ã€å¼€æºçš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰æ¡†æ¶ï¼Œ
åŸºäº HTTP/2 åè®®è¿›è¡Œé€šä¿¡ï¼Œä½¿ç”¨ Protocol Buffersï¼ˆprotobufï¼‰ä½œä¸ºæ¥å£å®šä¹‰è¯­è¨€ï¼Œå¯ä»¥çœ‹ä¸ºä¸€ç§åè®®ã€‚
<strong>grpcå¯ä»¥ç”¨äºå„ç§ä¸åŒæœåŠ¡é—´çš„é€šä¿¡ï¼Œå±è”½åº•å±‚ç»†èŠ‚(å¦‚ç¼–ç¨‹è¯­è¨€ï¼Œæ“ä½œç³»ç»Ÿç­‰)</strong></p>
<p>ç”±äºæˆ‘çš„ä¸€ä¸ªgoåç«¯(ä¹Ÿå¯ä»¥ä¸æ˜¯go)éœ€è¦å®ç°ç¥ç»ç½‘ç»œç›¸å…³çš„åŠŸèƒ½ï¼Œæˆ‘è¦è°ƒç”¨ä¸€ä¸ªpythonçš„æœåŠ¡ï¼Œäºæ˜¯æƒ³åˆ°äº†ä½¿ç”¨grpcçš„æ–¹å¼ã€‚</p>
<p>åˆæ¬¡æ¥è§¦ï¼Œå°†ä»0ä»‹ç»åˆ°åŠŸèƒ½å®ç°ã€‚</p>
<p>æ„Ÿè°¢å®˜æ–¹çš„æ–‡æ¡£</p>
<blockquote>
<p><a href="https://grpc.io/docs/languages/go/quickstart/" rel="external" target="_self">https://grpc.io/docs/languages/go/quickstart/</a></p>
</blockquote>
<h2 id="ä¸»è¦æµç¨‹">ä¸»è¦æµç¨‹<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<ul>
<li>å®šä¹‰.protoæ–‡ä»¶ï¼šåˆ›å»ºä¸€ä¸ª .proto æ–‡ä»¶ï¼Œå®šä¹‰å›¾æ•°æ®å’Œ GCN ç»“æœçš„æ¶ˆæ¯ç±»å‹ä»¥åŠæœåŠ¡æ¥å£ã€‚</li>
<li>ç”Ÿæˆ gRPC ä»£ç ï¼šä½¿ç”¨ Protocol Buffers ç¼–è¯‘å™¨ protocï¼Œæ ¹æ® .proto æ–‡ä»¶ç”Ÿæˆ Go å’Œ Python çš„ gRPC ä»£ç ã€‚</li>
<li>å®ç° Python æœåŠ¡å™¨ï¼šåœ¨ Python ä¸­å®ç° gRPC æœåŠ¡å™¨ï¼Œæ¥æ”¶æ¥è‡ª Go å®¢æˆ·ç«¯çš„å›¾æ•°æ®ï¼Œè¿›è¡Œ GCN å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†ç»“æœã€‚</li>
<li>å®ç° Go å®¢æˆ·ç«¯ï¼šåœ¨ Go ä¸­å®ç° gRPC å®¢æˆ·ç«¯ï¼Œå‘é€å›¾æ•°æ®åˆ° Python æœåŠ¡å™¨ï¼Œå¹¶æ¥æ”¶å¤„ç†ç»“æœã€‚</li>
</ul>
<h2 id="å®‰è£…protocè§£é‡Šå™¨">å®‰è£…protocè§£é‡Šå™¨<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>grpcæ˜¯é€šè¿‡pb(protocolbuffer)è¿™ä¸ªåè®®å·¥ä½œçš„ï¼Œé¦–å…ˆå®‰è£…protocçš„è§£é‡Šå™¨ï¼Œå¹¶å°†å…¶binæ–‡ä»¶å¤¹æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ã€‚
åœ°å€ï¼š<a href="https://github.com/protocolbuffers/protobuf/releases" rel="external" target="_self">https://github.com/protocolbuffers/protobuf/releases</a>
ä¸‹è½½åè§£å‹åˆ°ä»»æ„æ–‡ä»¶å¤¹ä½ç½®ï¼Œç„¶åå°†è§£å‹åçš„binæ–‡ä»¶å¤¹æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ã€‚</p>
<p>æ‰“å¼€cmdè¾“å…¥ <code>protoc</code>æœ‰æ•°æ®è¿”å›å°±okäº†ã€‚</p>
<p><strong>ä¸ºäº†åœ¨é¡¹ç›®ä¸­ä½¿ç”¨protocçš„ä¸€äº›æŒ‡ä»¤å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œè¿˜æœ‰æŠŠbinæ–‡ä»¶ä¸‹çš„ <code>protoc.exe</code>æ–‡ä»¶å¤åˆ¶ä¸€ä»½åˆ° <code>C:\Windows\System32</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</strong></p>
<p>é¡ºä¾¿ä¸€æï¼Œä¸ºäº†protoæ–‡ä»¶å¯ä»¥åœ¨vscodeé«˜äº®æ˜¾ç¤ºï¼Œå¯ä»¥å®‰è£…å®˜æ–¹çš„æ’ä»¶ï¼šprotobufï¼Œä½œè€…ï¼špbkit</p>
<h2 id="goç«¯å·¥ä½œ">goç«¯å·¥ä½œ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>é¦–å…ˆå®‰è£…goçš„grpcåº“</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="k">go</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="o">-</span><span class="nx">u</span><span class="w"> </span><span class="nx">google</span><span class="p">.</span><span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">grpc</span></span></span></code></pre></div>
<p>ç„¶åå®‰è£…å¯ä»¥å°†protoæ–‡ä»¶è‡ªåŠ¨è§£æä¸ºgoæ–‡ä»¶çš„è§£é‡Šå™¨ï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="k">go</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">google</span><span class="p">.</span><span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">protobuf</span><span class="o">/</span><span class="nx">cmd</span><span class="o">/</span><span class="nx">protoc</span><span class="o">-</span><span class="nx">gen</span><span class="o">-</span><span class="k">go</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">go</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">google</span><span class="p">.</span><span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">grpc</span><span class="o">/</span><span class="nx">cmd</span><span class="o">/</span><span class="nx">protoc</span><span class="o">-</span><span class="nx">gen</span><span class="o">-</span><span class="k">go</span><span class="o">-</span><span class="nx">grpc</span></span></span></code></pre></div>
<p>å®šä¹‰protoæ–‡ä»¶ <code>gcn.proto</code>ï¼š
å…¶ä¸­go_packageæ˜¯æŒ‡å®šç”Ÿæˆçš„æ–‡ä»¶ä½ç½®å’Œæ–‡ä»¶æ‰€åœ¨åŒ…åã€‚â€œ.â€ è¡¨ç¤ºæ–‡ä»¶ç”Ÿæˆåœ¨å½“å‰ç›®å½•ï¼Œâ€œï¼›â€è¡¨ç¤ºå‚æ•°åˆ†å‰²ï¼Œåé¢çš„protoæ˜¯å°†ç”Ÿæˆæ–‡ä»¶æ”¾åœ¨protoåŒ…ä¸­ã€‚
è¿˜æœ‰æ›´å¤šå¯é€‰å‚æ•°ï¼Œè‡ªè¡Œå‚è€ƒå®˜æ–¹</p>
<blockquote>
<p>go_packageï¼šæŒ‡å®šç”Ÿæˆ Go ä»£ç æ—¶çš„åŒ…è·¯å¾„ï¼Œæ ¼å¼ä¸º option go_package = &ldquo;package_path&rdquo;;ï¼Œç”¨äºå°†ç”Ÿæˆçš„ä»£ç æ”¾ç½®åœ¨æŒ‡å®šçš„ Go åŒ…ä¸­ã€‚</p>
<p>java_packageï¼šæŒ‡å®šç”Ÿæˆ Java ä»£ç æ—¶çš„åŒ…è·¯å¾„ï¼Œæ ¼å¼ä¸º option java_package = &ldquo;package_path&rdquo;;ï¼Œç”¨äºå°†ç”Ÿæˆçš„ä»£ç æ”¾ç½®åœ¨æŒ‡å®šçš„ Java åŒ…ä¸­ã€‚</p>
<p>java_outer_classnameï¼šæŒ‡å®šç”Ÿæˆ Java ä»£ç æ—¶çš„å¤–éƒ¨ç±»åï¼Œæ ¼å¼ä¸º option java_outer_classname = &ldquo;ClassName&rdquo;;ï¼Œç”¨äºæŒ‡å®šç”Ÿæˆçš„ Java ç±»çš„å¤–éƒ¨ç±»åã€‚</p>
<p>cc_generic_servicesï¼šæŒ‡å®šæ˜¯å¦ç”Ÿæˆ C++ é€šç”¨æœåŠ¡ï¼ˆgeneric servicesï¼‰ï¼Œæ ¼å¼ä¸º option
cc_generic_services = true; æˆ– option cc_generic_services = false;ï¼Œé»˜è®¤ä¸º
trueã€‚</p>
<p>cc_enable_arenasï¼šæŒ‡å®šæ˜¯å¦å¯ç”¨ C++ arenas å†…å­˜ç®¡ç†ï¼Œæ ¼å¼ä¸º option cc_enable_arenas =
true; æˆ– option cc_enable_arenas = false;ï¼Œé»˜è®¤ä¸º falseã€‚</p>
<p>optimize_forï¼šæŒ‡å®šä¼˜åŒ–é€‰é¡¹ï¼Œå¯ä»¥æ˜¯ SPEEDã€CODE_SIZE æˆ– LITE_RUNTIMEï¼Œæ ¼å¼ä¸º option
optimize_for = SPEED;ï¼Œé»˜è®¤ä¸º SPEEDã€‚</p>
<p>deprecatedï¼šæŒ‡å®šæ¶ˆæ¯æˆ–å­—æ®µå·²è¿‡æ—¶ï¼Œæ ¼å¼ä¸º option deprecated = true;ã€‚</p>
<p>rpc_timeoutï¼šæŒ‡å®š gRPC è°ƒç”¨çš„è¶…æ—¶æ—¶é—´ï¼Œæ ¼å¼ä¸º option rpc_timeout = &ldquo;10s&rdquo;;ï¼Œè¡¨ç¤ºè¶…æ—¶æ—¶é—´ä¸º 10
ç§’ã€‚</p>
</blockquote>
<p>gcn.protoåè®®æ–‡ä»¶å…·ä½“å®šä¹‰ä¸ºï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">syntax</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#34;proto3&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">option</span><span class="w"> </span><span class="nx">go_package</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#34;.;proto&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">message</span><span class="w"> </span><span class="nx">Node</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">repeated</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="nx">features</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">message</span><span class="w"> </span><span class="nx">Edge</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nx">source_id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="nx">target_id</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">message</span><span class="w"> </span><span class="nx">GraphData</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">repeated</span><span class="w"> </span><span class="nx">Node</span><span class="w"> </span><span class="nx">nodes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">repeated</span><span class="w"> </span><span class="nx">Edge</span><span class="w"> </span><span class="nx">edges</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">message</span><span class="w"> </span><span class="nx">GCNResult</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kd">map</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">node_scores</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">service</span><span class="w"> </span><span class="nx">GCNService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">rpc</span><span class="w"> </span><span class="nf">ProcessGraph</span><span class="p">(</span><span class="nx">GraphData</span><span class="p">)</span><span class="w"> </span><span class="nf">returns</span><span class="w"> </span><span class="p">(</span><span class="nx">GCNResult</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>æˆ‘è¿™é‡Œæ˜¯ç”¨æ¥å¤„ç†å›¾æ•°æ®ã€‚</p>
<p>æ¥ä¸‹æ¥ç”Ÿæˆ gRPC ä»£ç ï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">protoc</span><span class="w"> </span><span class="o">--</span><span class="nx">go_out</span><span class="p">=.</span><span class="w"> </span><span class="o">--</span><span class="nx">go_opt</span><span class="p">=</span><span class="nx">paths</span><span class="p">=</span><span class="nx">source_relative</span><span class="w"> </span><span class="nx">your_proto_file</span><span class="p">.</span><span class="nx">proto</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="nx">protoc</span><span class="w"> </span><span class="o">--</span><span class="k">go</span><span class="o">-</span><span class="nx">grpc_out</span><span class="p">=.</span><span class="w"> </span><span class="o">--</span><span class="k">go</span><span class="o">-</span><span class="nx">grpc_opt</span><span class="p">=</span><span class="nx">paths</span><span class="p">=</span><span class="nx">source_relative</span><span class="w"> </span><span class="nx">your_proto_file</span><span class="p">.</span><span class="nx">proto</span></span></span></code></pre></div>
<p>ä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ <code>gcn.pb.go</code>å’Œ <code>gcn_grpc.pb.go</code></p>
<ul>
<li>å‰è€…ç”Ÿæˆçš„æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰pbåè®®çš„goä»£ç ï¼Œå°†æ•°æ®æ ¼å¼å†™ä¸ºgoçš„ç»“æ„ä½“å½¢å¼ã€‚åŒ…å«å¡«å……ã€åºåˆ—åŒ–ï¼Œæ£€ç´¢è¯·æ±‚å’Œå“åº”æ¶ˆæ¯ç±»å‹ã€‚</li>
<li>åè€…åŒ…å«<strong>å®¢æˆ·ç«¯</strong>ä½¿ç”¨ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œè°ƒç”¨çš„æ¥å£ç±»å‹ã€‚ä»¥åŠ<strong>æœåŠ¡ç«¯</strong>è¦å®ç°çš„æ¥å£ç±»å‹ã€‚åŒ…å«åˆ›å»ºå®¢æˆ·ç«¯æœåŠ¡å’ŒæœåŠ¡ç«¯æœåŠ¡çš„æ–¹æ³•ã€‚
<strong>è¯·æ³¨æ„ï¼Œæ— è®ºgoåç«¯ä½œä¸ºè¯·æ±‚grpcçš„ä¸€æ–¹(client)è¿˜æ˜¯åšå‡ºå“åº”çš„ä¸€æ–¹(server),è¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½æ˜¯å¿…é¡»ç”Ÿæˆçš„ã€‚</strong>
ä½¿ç”¨ <code>client := pb.NewXXXXServiceClient(conn)</code>çš„æ–¹å¼åˆ›å»ºå®¢æˆ·ç«¯</li>
</ul>
<p>æœ€åå°±æ˜¯å®Œæˆgoç«¯çš„grpcè¯·æ±‚ä»£ç ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½åˆ›å»ºä¸€ä¸ªgrpcçš„è¿æ¥ï¼Œè¯·æ±‚å®Œæ¯•deferæ–­å¼€ï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span><span class="w"> </span><span class="nf">GCN_request</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">float32</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nx">conn</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">grpc</span><span class="p">.</span><span class="nf">Dial</span><span class="p">(</span><span class="s">&#34;localhost:9999&#34;</span><span class="p">,</span><span class="w"> </span><span class="nx">grpc</span><span class="p">.</span><span class="nf">WithTransportCredentials</span><span class="p">(</span><span class="nx">insecure</span><span class="p">.</span><span class="nf">NewCredentials</span><span class="p">()))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">// Failed to connect to gcnserver(py) by grpc</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">defer</span><span class="w"> </span><span class="nx">conn</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nx">client</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">pb</span><span class="p">.</span><span class="nf">NewGCNServiceClient</span><span class="p">(</span><span class="nx">conn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="c1">// åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„å›¾æ•°æ®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nx">G_example</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">pb</span><span class="p">.</span><span class="nx">GraphData</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">Nodes</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">pb</span><span class="p">.</span><span class="nx">Node</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="nx">Id</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;node1&#34;</span><span class="p">,</span><span class="w"> </span><span class="nx">Features</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">{</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">}},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="nx">Id</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;node2&#34;</span><span class="p">,</span><span class="w"> </span><span class="nx">Features</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">float32</span><span class="p">{</span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">}},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nx">Edges</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">pb</span><span class="p">.</span><span class="nx">Edge</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="nx">SourceId</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;node1&#34;</span><span class="p">,</span><span class="w"> </span><span class="nx">TargetId</span><span class="p">:</span><span class="w"> </span><span class="s">&#34;node2&#34;</span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="c1">// å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="nx">result</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">client</span><span class="p">.</span><span class="nf">ProcessGraph</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span><span class="w"> </span><span class="nx">G_example</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">// Error calling ProcessGraph</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">NodeScores</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>æœ€åçš„æœ€ååˆ«å¿˜äº†åˆ›å»ºä¸€ä¸ªè·¯ç”±è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<h2 id="pythonç«¯å·¥ä½œ">pythonç«¯å·¥ä½œ<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>pyåŒæ ·å®‰è£…grpcç›¸å…³åº“</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">grpcio</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span> <span class="n">install</span> <span class="n">grpcio</span><span class="o">-</span><span class="n">tools</span></span></span></code></pre></div>
<h3 id="ç”Ÿæˆgrpcæ–‡ä»¶">ç”Ÿæˆgrpcæ–‡ä»¶<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ç»ˆç«¯cdåˆ°protoæ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ‰§è¡Œï¼š</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">grpc_tools</span><span class="o">.</span><span class="n">protoc</span> <span class="o">-</span><span class="n">I</span> <span class="o">./</span> <span class="o">--</span><span class="n">python_out</span><span class="o">=./</span> <span class="o">--</span><span class="n">grpc_python_out</span><span class="o">=.</span> <span class="n">your</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">proto</span></span></span></code></pre></div>
<p>pyçš„æœåŠ¡ç«¯ä»£ç grpcç›¸å…³çš„ä»£ç è¾ƒä¸ºç®€æ´ï¼Œé‡ç‚¹åœ¨äºæ•°æ®å¤„ç†ã€‚å°†å…¶æœåŠ¡ç«¯å£å’Œgrpcå®¢æˆ·ç«¯çš„è¯·æ±‚ç«¯å£ä¿æŒä¸€è‡´ã€‚
éƒ¨åˆ†ä»£ç å–è‡ªå®˜æ–¹ç¤ºä¾‹ã€‚</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">grpc</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">proto</span> <span class="kn">import</span> <span class="n">gcn_pb2_grpc</span><span class="p">,</span> <span class="n">gcn_pb2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">GCNServicer</span><span class="p">(</span><span class="n">gcn_pb2_grpc</span><span class="o">.</span><span class="n">GCNServiceServicer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">ProcessGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Process graph data using GCN and return result</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># example: return gcn_pb2.GCNResult(node_scores={&#34;node1&#34;: 0.5, &#34;node2&#34;: 0.8})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">server</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span> <span class="o">=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">server</span><span class="p">(</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">gcn_pb2_grpc</span><span class="o">.</span><span class="n">add_GCNServiceServicer_to_server</span><span class="p">(</span><span class="n">GCNServicer</span><span class="p">(),</span> <span class="n">server</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">add_insecure_port</span><span class="p">(</span><span class="s1">&#39;[::]:9999&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gRPC æœåŠ¡ç«¯å·²å¼€å¯,ç«¯å£ä¸º9999...&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">wait_for_termination</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="p">()</span></span></span></code></pre></div>
<h2 id="å¯åŠ¨">å¯åŠ¨<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>åšå¥½äº†ä»¥ä¸Šå·¥ä½œå°±å¤§åŠŸå‘Šæˆäº†ï¼Œå¯åŠ¨ä¸¤ä¸ªæœåŠ¡å³å¯</p>
<p><code>go run main.go</code></p>
<p><code>python server.py</code></p>
<p>ç„¶åè®¿é—®å®šä¹‰çš„è·¯ç”±åœ°å€ï¼Œå¦‚ä¸‹æ˜¾ç¤ºï¼Œnice~</p>
<p><a href="#R-image-706a5cf788c3a15142bfc0de6bf60eef" class="lightbox-link"><img alt="2" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/grpc-go-python/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-706a5cf788c3a15142bfc0de6bf60eef"><img alt="2" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/grpc-go-python/1.png"></a></p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Mar 21, 2024
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/css/index.html">CSS</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/mac%E9%A3%8E%E6%A0%BC/index.html">Macé£æ ¼</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/prism/index.html">Prism</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/typecho/index.html">Typecho</a></li>
  </ul>
</div>
  </header>

<h1 id="typechoä¸­ä»£ç é«˜äº®å¹¶æœ‰macé£æ ¼">Typechoä¸­ä»£ç é«˜äº®å¹¶æœ‰Macé£æ ¼</h1>

<h2 id="ä¸‰æ­¥">ä¸‰æ­¥<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<ul>
<li>ä¸‹è½½prismæ–‡ä»¶ã€‚</li>
<li>åœ¨headä¸­å¼•ç”¨ï¼Œå¹¶æ·»åŠ è¡Œå·ç±»ã€‚</li>
<li>ä¿®æ”¹CSSã€‚</li>
</ul>
<h3 id="ç¬¬ä¸€æ­¥å®˜ç½‘ä¸‹è½½é€‰æ‹©è¯­è¨€å’Œéœ€è¦çš„æ’ä»¶">ç¬¬ä¸€æ­¥ï¼šå®˜ç½‘ä¸‹è½½ï¼Œé€‰æ‹©è¯­è¨€å’Œéœ€è¦çš„æ’ä»¶<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æ˜“å¾—</p>
<h3 id="ç¬¬äºŒæ­¥headerphpæ–‡ä»¶çš„headå—ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ">ç¬¬äºŒæ­¥ï¼šheader.phpæ–‡ä»¶çš„headå—ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç <span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="nx">ä¸ºpreå—æ·»åŠ </span> <span class="nx">line</span><span class="o">-</span><span class="nx">numbers</span> <span class="nx">ç±»</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">document</span><span class="o">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;DOMContentLoaded&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">var</span> <span class="nx">codeBlocks</span> <span class="o">=</span> <span class="nx">document</span><span class="o">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;.post-content pre:not(.line-numbers)&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">codeBlocks</span><span class="o">.</span><span class="k">forEach</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">codeBlock</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">codeBlock</span><span class="o">.</span><span class="nx">classList</span><span class="o">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;line-numbers&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="nx">prism</span> <span class="nx">ä»£ç é«˜äº®</span><span class="o">&amp;</span><span class="nx">ä¸»é¢˜é€‰æ‹©</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;!--</span> <span class="nx">æ³¨æ„prismjs_theme</span> <span class="nx">æ˜¯æˆ‘åœ¨functionæ–‡ä»¶ä¸­å®šä¹‰çš„</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;?</span><span class="nx">php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">options</span><span class="o">-&gt;</span><span class="na">prismjs_theme</span> <span class="o">==</span> <span class="s1">&#39;tomorrow&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;link rel=&#34;stylesheet&#34; href=&#34;&lt;?php $this-&gt;options-&gt;themeUrl(&#39;æ›¿æ¢ä¸ºä½ çš„prism.cssçš„è·¯å¾„ï¼Œä¸‹åŒ&#39;); ?&gt;&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;script src=&#34;&lt;?php $this-&gt;options-&gt;themeUrl(&#39;æ›¿æ¢ä¸ºä½ çš„prism.jsçš„è·¯å¾„ï¼Œä¸‹åŒ&#39;); ?&gt;&#34;&gt;&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;?php elseif ($this-&gt;options-&gt;prismjs_theme == &#39;coy&#39;) : ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;link rel=&#34;stylesheet&#34; href=&#34;&lt;?php $this-&gt;options-&gt;themeUrl(&#39;prismjs/coy/prism.css&#39;); ?&gt;&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;script src=&#34;&lt;?php $this-&gt;options-&gt;themeUrl(&#39;prismjs/coy/prism.js&#39;); ?&gt;&#34;&gt;&lt;/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;?php endif; ?&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;!-- ä¿®æ”¹ä¸ºmacæ ·å¼,è¯·æ›¿æ¢ä½ çš„mac.cssæ–‡ä»¶è·¯å¾„--&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    &lt;link rel=&#34;stylesheet&#34; href=&#34;&lt;?php $this-&gt;options-&gt;themeUrl(&#39;css/mac.css&#39;); ?&gt;&#34; /&gt;
</span></span></span></code></pre></div>
<h3 id="ç¬¬ä¸‰æ­¥ä¿®æ”¹æ»¡æ„çš„css">ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹æ»¡æ„çš„CSS<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ä¸‹é¢åªå†™äº† <code>mac.css</code>æ–‡ä»¶ã€‚
<strong>æ³¨æ„ï¼Œæˆ‘çš„æ•ˆæœä¹Ÿä¿®æ”¹äº†ä¸‹è½½äº† <code>prism.css</code>æ–‡ä»¶ã€‚</strong>
æ›´å…·ä½“çš„csså¯ä»¥å‚è€ƒæˆ‘çš„githubä»“åº“ï¼Œè¯¥ä¸»é¢˜æ˜¯å¼€æºçš„ã€‚</p>
<div class="highlight actionbar-wrapper wrap-code" dir="auto"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="c">/* macOS é£æ ¼çš„ä»£ç æ¡†æ ·å¼ */</span>
</span></span><span class="line"><span class="cl"><span class="nt">pre</span><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="nt">language-</span><span class="o">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">border-radius</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">    <span class="k">box-shadow</span><span class="p">:</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">transition</span><span class="p">:</span> <span class="k">box-shadow</span> <span class="mf">0.3</span><span class="kt">s</span> <span class="kc">ease-in-out</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">max-height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">max-width</span><span class="p">:</span> <span class="mi">85</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding-top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/* macOS é£æ ¼çš„å›¾æ ‡ */</span>
</span></span><span class="line"><span class="cl"><span class="nt">pre</span><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="nt">language-</span><span class="o">]</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">content</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">background</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&#34;../img/icon_mac.svg&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">background-position-y</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">top</span><span class="p">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">left</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">height</span><span class="p">:</span> <span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">width</span><span class="p">:</span> <span class="mi">54</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">margin-left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">/* æ‚¬æµ® */</span>
</span></span><span class="line"><span class="cl"><span class="nt">pre</span><span class="o">[</span><span class="nt">class</span><span class="o">*=</span><span class="nt">language-</span><span class="o">]</span><span class="p">:</span><span class="nd">hover</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">25</span><span class="kt">px</span> <span class="mi">15</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span></span></span></code></pre></div>
<h2 id="ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»æˆ‘çš„ä»“åº“æ‹‰å–æºä»£ç ayakin">ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»æˆ‘çš„ä»“åº“æ‹‰å–æºä»£ç ï¼ğŸ‘‰ğŸ‘‰<strong><a href="https://github.com/viogami/Ayakin-TypechoTheme" rel="external" target="_self">Ayakin</a></strong><span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Dec 10, 2023
  </footer>
</article>
<article class="default">
  <header class="headline">
<div class="R-taxonomy taxonomy-tags cstyle tags" title="Tags" style="--VARIABLE-TAGS-BG-color: var(--INTERNAL-TAG-BG-color);">
  <i class="fa-fw fas fa-layer-group"></i>
  <ul>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/bot/index.html">Bot</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/go/index.html">Go</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/telegram/index.html">Telegram</a></li>
    <li><a class="term-link" href="/hugo-theme-relearn/tags/webhook/index.html">Webhook</a></li>
  </ul>
</div>
  </header>

<h1 id="telegram-botéƒ¨ç½²">Telegram Botéƒ¨ç½²</h1>

<h2 id="åŸºæœ¬ç¤ºä¾‹æˆ‘æ”¾åœ¨äº†githubä¸Šgobot">åŸºæœ¬ç¤ºä¾‹æˆ‘æ”¾åœ¨äº†githubä¸Šï¼š<a href="https://github.com/viogami/viogo" rel="external" target="_self">Gobot</a><span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<h2 id="æœ€ç»ˆå®ç°æ•ˆæœ-">æœ€ç»ˆå®ç°æ•ˆæœ ğŸ‘‡ğŸ‘‡ğŸ‘‡<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p><a href="#R-image-ec2819530d6f47ac27b2964deea8a738" class="lightbox-link"><img alt="img" class="bg-white border lazy lightbox figure-image" loading="lazy" src="/hugo-theme-relearn/blog/telegram-bot/1.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ec2819530d6f47ac27b2964deea8a738"><img alt="img" class="bg-white border lazy lightbox lightbox-image" loading="lazy" src="/hugo-theme-relearn/blog/telegram-bot/1.png"></a></p>
<h2 id="åˆ›å»ºbot">åˆ›å»ºbot<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>ä»botfatherå¤„åˆ›å»ºbotï¼Œå‘½åä¸º <code>vio</code>.
æ˜ç¡®ä½¿ç”¨éœ€æ±‚å’Œç›®çš„ï¼Œè¿›è€Œé€‰æ‹©å¼€å‘å·¥å…·å’Œç›¸å…³åº“(ä¸»è¦ä½¿ç”¨goå’Œcollyåº“ï¼Œtgå®˜æ–¹ä¹Ÿæœ‰goçš„apiåº“)</p>
<h2 id="ä½¿ç”¨https">ä½¿ç”¨HTTPS<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>åœ¨Telegramçš„Bot APIä¸­ï¼Œä½¿ç”¨HTTPSæ˜¯å¼ºçƒˆå»ºè®®çš„ã€‚å¦‚æœBotä½¿ç”¨HTTPè€Œä¸æ˜¯HTTPSï¼ŒTelegramæœåŠ¡å™¨å¯èƒ½ä¼šæ‹’ç»å¤„ç†è¯·æ±‚ã€‚
ä¸ºäº†ç¡®ä¿Tg Botèƒ½å¤Ÿæ­£å¸¸è¿è¡Œå¹¶ä¿éšœé€šä¿¡å®‰å…¨ï¼Œæœ€å¥½ä½¿ç”¨HTTPSã€‚è®¸å¤šæœåŠ¡æä¾›å•†éƒ½æä¾›å…è´¹çš„SSLè¯ä¹¦.
å¦‚ï¼š<strong>Let&rsquo;s Encryptè¯ä¹¦</strong>ï¼Œå®ƒæ˜¯ä¸€ç§å…è´¹çš„ã€å¼€æºçš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œå¯ä»¥ç”¨æ¥ä¸ºæœåŠ¡å™¨å¯ç”¨HTTPSï¼Œä»è€Œå®ç°å®‰å…¨çš„Boté€šä¿¡ã€‚</p>
<p>ä½†æ˜¯å¦‚æœéƒ¨ç½²åœ¨paaså¹³å°ï¼Œåˆ™æ— éœ€è€ƒè™‘è¯ä¹¦ç›¸å…³çš„é—®é¢˜ï¼Œæ›´å¤šéƒ¨ç½²ç»†èŠ‚å¯ä»¥æŸ¥çœ‹æˆ‘ <a href="https://github.com/viogami/viogo#%E8%AF%81%E4%B9%A6%E9%97%AE%E9%A2%98" rel="external" target="_self">ä»“åº“çš„è¯´æ˜</a></p>
<h2 id="å“åº”æ–¹å¼">å“åº”æ–¹å¼<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>Telegram Botæœ‰ä»¥ä¸‹å“åº”æ–¹å¼ï¼š</p>
<p>é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰ï¼š è¿™æ˜¯ä¸€ç§å¸¸è§çš„å®æ—¶é€šä¿¡æ–¹å¼ã€‚Botå‘TelegramæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨ä¸€ç›´ä¿æŒè¿æ¥æ‰“å¼€ï¼Œç›´åˆ°æœ‰æ–°æ¶ˆæ¯åˆ°è¾¾ã€‚è¿™æ ·ï¼ŒBotèƒ½å¤Ÿå³æ—¶æ”¶åˆ°ç”¨æˆ·çš„æ¶ˆæ¯å¹¶ç«‹å³ä½œå‡ºå“åº”ã€‚é•¿è½®è¯¢æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„æ–¹å¼ï¼Œé€‚ç”¨äºéœ€è¦å®æ—¶æ€§çš„åœºæ™¯ã€‚</p>
<p>Webhookï¼š Webhookæ˜¯ä¸€ç§æ›´ä¸ºé«˜æ•ˆå’Œç°ä»£çš„æ–¹å¼ã€‚å…è®¸ä½ åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šè®¾ç½®ä¸€ä¸ªHTTPç«¯ç‚¹ï¼Œå½“æœ‰æ–°æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼ŒTelegramæœåŠ¡å™¨ä¼šå‘è¿™ä¸ªç«¯ç‚¹å‘é€POSTè¯·æ±‚ã€‚è¿™æ ·ï¼Œä½ çš„Botå¯ä»¥ç«‹å³å¾—çŸ¥æœ‰æ–°æ¶ˆæ¯ï¼Œå¹¶ä½œå‡ºå“åº”ã€‚ä½¿ç”¨Webhookèƒ½å¤Ÿé¿å…é¢‘ç¹çš„è½®è¯¢æ“ä½œï¼Œæé«˜æ•ˆç‡ã€‚</p>
<p>äº‘å‡½æ•°ï¼ˆCloud Functionsï¼‰ï¼š ä½ è¿˜å¯ä»¥å°†Botçš„éƒ¨åˆ†åŠŸèƒ½éƒ¨ç½²åˆ°äº‘å‡½æ•°ï¼ˆå¦‚AWS Lambdaã€Google Cloud Functionsç­‰ï¼‰ä¸Šï¼Œä»¥å“åº”ç‰¹å®šçš„äº‹ä»¶ã€‚è¿™æ ·å¯ä»¥å®ç°é«˜åº¦çš„å¯ä¼¸ç¼©æ€§å’Œå“åº”æ€§ã€‚</p>
<h2 id="webhook">webhook<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>ä¸ºäº†æœ‰è¾ƒå¥½çš„å®æ—¶é€šä¿¡ä½“éªŒï¼Œå¹¶ä¸”å®Œæˆå¤šæ–¹é€šä¿¡ï¼Œæˆ‘å‡†å¤‡ä½¿ç”¨webhookçš„æ–¹æ¡ˆã€‚</p>
<p><strong>è®¾ç½®Webhookç«¯ç‚¹</strong>ï¼š åœ¨æˆ‘æœåŠ¡å™¨ä¸Šï¼Œåˆ›å»ºä¸€ä¸ªHTTPç«¯ç‚¹æ¥æ¥æ”¶Telegramçš„Webhookè¯·æ±‚ã€‚è¿™ä¸ªç«¯ç‚¹éœ€è¦è¿è¡Œåœ¨å…¬å…±ç½‘ç»œä¸Šï¼Œå¹¶ä¸”èƒ½å¤Ÿå¤„ç†POSTè¯·æ±‚ã€‚è¿™ä¸ªç«¯ç‚¹å°†ä¼šæ¥æ”¶åˆ°æ‰€æœ‰çš„Telegramæ¶ˆæ¯ã€‚</p>
<p><strong>é…ç½®Botçš„Webhook</strong>ï¼š ä½¿ç”¨Telegram Bot APIè®¾ç½®Botçš„Webhookï¼ŒæŒ‡å‘åˆšåˆšåˆ›å»ºçš„HTTPç«¯ç‚¹ã€‚å¯ä»¥ä½¿ç”¨NewWebhookæ–¹æ³•ï¼ŒæŒ‡å®šWebhookçš„URL(æˆ‘éƒ¨ç½²åœ¨paaså¹³å°ä¸Šï¼Œæ— éœ€ä½¿ç”¨è¯ä¹¦å¯†é’¥)ã€‚</p>
<h2 id="paaså¹³å°éƒ¨ç½²">paaså¹³å°éƒ¨ç½²<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<p>æˆ‘é€‰æ‹©äº†zeaburè¿™ä¸ªæœåŠ¡æä¾›å¹³å°,</p>
<p>zeaburä¸Šé¡¹ç›®éƒ¨ç½²éå¸¸å¿«,ç”šè‡³ä¸ç”¨å†™dockfile,è€Œä¸”å¯¹goé¡¹ç›®æœ‰å®Œæ•´çš„æ”¯æŒ,ç®—æ˜¯ç¬¦åˆä»–ä»¬çš„å£å·:</p>
<blockquote>
<p>Deploying your service with one click</p>
</blockquote>
<p>åœ¨ä½¿ç”¨paasæœåŠ¡æ—¶ï¼Œéœ€è¦æ³¨æ„é¡¹ç›®çš„ç«¯å£å·è®¾ç½®,æœ€å¥½è®¾ç½®åœ¨ç¯å¢ƒå˜é‡ä¸­,ç„¶ååœ¨é¡¹ç›®ä¸­é€šè¿‡ <code>os.Getenv(&quot;xxx&quot;)</code>æ¥è·å–ç«¯å£å·.</p>
<p>zeaburçš„goé¡¹ç›®ä¸­ï¼Œç¯å¢ƒå˜é‡PORTæ˜¯é»˜è®¤8080ï¼Œä¸”ä¸ºå…¨å±€çš„ã€‚ä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼Œç›´æ¥è°ƒç”¨å°±å¥½äº†ã€‚</p>
<ul>
<li>å¯¹äºtgbotï¼šå®˜æ–¹ç¤ºä¾‹ä¸­ä½¿ç”¨çš„8443ç«¯å£ï¼Œåœ¨éƒ¨ç½²åˆ°paaså¹³å°æ—¶8443ç«¯å£éœ€è¦ç¡®è®¤æ˜¯å¦å¼€æ”¾ã€‚ æˆ‘å»ºè®®ä¸è¦ä½¿ç”¨å®˜æ–¹ç¤ºä¾‹ä¸­æŠŠç«¯å£å·å†™æ˜çš„å†™æ³•ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡PORTè°ƒç”¨ç«¯å£å·ï¼Œé¿å…webhookåˆ›å»ºå¤±è´¥ï¼Œæˆ–è€…ç›‘å¬æœªå¼€æ”¾çš„ç«¯å£ç­‰é—®é¢˜ã€‚</li>
</ul>
<h2 id="è°ƒç”¨chatgpt-api">è°ƒç”¨chatGPT API<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2>
<h3 id="é¦–å…ˆè·å–å¯†é’¥">é¦–å…ˆè·å–å¯†é’¥<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>ä½†æ˜¯æ³¨æ„ï¼Œä¸æ˜¯ç”³è¯·äº†è´¦å·å¯†é’¥å°±å¯ä»¥ä½¿ç”¨çš„ï¼Œåªæœ‰ä¸‰ä¸ªæœˆå†…æ³¨å†Œçš„è´¦å·æ¯ä¸ªæœˆæœ‰å…è´¹çš„5$çš„é¢åº¦ã€‚å¦‚æœæ²¡æœ‰é¢åº¦ï¼Œç”³è¯·çš„å¯†é’¥ä¹Ÿæ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚å¾ˆå¤šè´­ä¹°çš„GPTçš„è´¦å·ï¼ŒapiåŸºæœ¬éƒ½æ˜¯æ²¡é¢åº¦æˆ–è€…é¢åº¦æ¯ä¸ªæœˆéƒ½è¢«å…¶ä»–äººç”¨å®Œçš„ï¼Œå¯ä»¥ä½¿ç”¨å›½å†…çš„ä¸­è½¬ä»£ç†ï¼Œæ¥è§£å†³å¯†é’¥çš„é—®é¢˜ã€‚ æˆ‘æ¨èä¸€ä¸ªï¼š<a href="https://one-api.bltcy.top/" rel="external" target="_self">æŸæ‹‰å›¾æ¬¡å…ƒAl</a></p>
<h3 id="gptä»£ç†é—®é¢˜">GPTä»£ç†é—®é¢˜<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨ä¸­è½¬ï¼Œéœ€è¦æ›´æ¢postè¯·æ±‚çš„URL</p>
<p>ä½¿ç”¨go-openaiåº“åï¼Œéœ€è¦æ›´æ”¹config
æ›´å¤šç»†èŠ‚å¯ä»¥æŸ¥çœ‹æœåŠ¡æä¾›å•†çš„æ–‡æ¡£ï¼Œä»¥åŠè¿™ä¸ª<a href="https://github.com/sashabaranov/go-openai/issues/513#issuecomment-1851585302" rel="external" target="_self">issue</a></p>
<p>ç¤ºä¾‹ï¼š<code>URLï¼š&quot;https://api.example.com/v1&quot;</code>.
å…¶ä¸­åé¢çš„â€œv1â€æ˜¯å¿…é¡»çš„</p>
<h3 id="å®ç°æ•°æ®å¤„ç†é€»è¾‘">å®ç°æ•°æ®å¤„ç†é€»è¾‘<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>å¯¹äºtgbotæ¥è¯´ï¼Œç§èŠè¦å›å¤ä¿¡æ¯éœ€è¦çŸ¥é“userçš„idæˆ–è€…usernameï¼Œä½†æ˜¯åœ¨ç¾¤é‡Œä¸­éœ€è¦çŸ¥é“chatçš„idã€‚</p>
<p>æ³¨æ„ï¼Œtgçš„ç¾¤ç»„åˆ†ä¸ºgroupå’Œsupergroupï¼Œå…¬å¼€çš„ç¾¤ç»„éƒ½æ˜¯supergroupï¼Œåªæœ‰ç§ç¾¤æ˜¯groupã€‚</p>
<p>è®¾ç½®äº†æ¶ˆæ¯å¤„ç†é€»è¾‘ï¼Œå¦‚æœæƒ³ç›´æ¥ç”¨chatgptçš„apiæ¥èŠå¤©ï¼Œå†™ä¸€ä¸ªå‡½æ•°è°ƒç”¨å°±å¯ä»¥äº†ã€‚</p>
<p>å¯¹äºgoè¯­è¨€æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªä»¥åŠå°è£…å¥½çš„ï¼Œå¯¹äºopenai APIä½¿ç”¨çš„åº“ï¼š<a href="https://github.com/sashabaranov/go-openai" rel="external" target="_self">go-openai</a></p>
<h3 id="é‡æ–°éƒ¨ç½²">é‡æ–°éƒ¨ç½²<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type="button" title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3>
<p>æŠŠchatGPTçš„APIå¯†é’¥å†™åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼ŒredeployæœåŠ¡å°±å¥½äº†</p>
<script src="https://giscus.app/client.js"
        data-repo="viogami/blog"
        data-repo-id="R_kgDOORWDyA"
        data-category="Announcements"
        data-category-id="DIC_kwDOORWDyM4Conxc"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Dec 7, 2023
  </footer>
</article>
          </section>
        </div>
      </main>
    </div>
    <script src="/hugo-theme-relearn/js/perfect-scrollbar/perfect-scrollbar.min.js?1769070402" defer></script>
    <script src="/hugo-theme-relearn/js/theme.min.js?1769070402" defer></script>
    <div id="toast-container" role="status" aria-live="polite" aria-atomic="false"></div>
  </body>
</html>
